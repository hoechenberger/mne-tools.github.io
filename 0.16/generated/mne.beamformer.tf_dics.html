<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mne.beamformer.tf_dics &#8212; MNE 0.16.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  <link rel="canonical" href="https://mne.tools/stable/index.html" />
</head><body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.16.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Install</a></li>
                <li><a href="../documentation.html">Documentation</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.16.1
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.16 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">mne.beamformer.tf_dics</a><ul>
<li><a class="reference internal" href="#examples-using-mne-beamformer-tf-dics">Examples using <code class="docutils literal notranslate"><span class="pre">mne.beamformer.tf_dics</span></code></a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="mne-beamformer-tf-dics">
<h1>mne.beamformer.tf_dics<a class="headerlink" href="#mne-beamformer-tf-dics" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mne.beamformer.tf_dics">
<code class="descclassname">mne.beamformer.</code><code class="descname">tf_dics</code><span class="sig-paren">(</span><em>epochs</em>, <em>forward</em>, <em>noise_csds</em>, <em>tmin</em>, <em>tmax</em>, <em>tstep</em>, <em>win_lengths</em>, <em>subtract_evoked=False</em>, <em>mode='fourier'</em>, <em>freq_bins=None</em>, <em>frequencies=None</em>, <em>n_ffts=None</em>, <em>mt_bandwidths=None</em>, <em>mt_adaptive=False</em>, <em>mt_low_bias=True</em>, <em>cwt_n_cycles=7</em>, <em>decim=1</em>, <em>reg=0.05</em>, <em>label=None</em>, <em>pick_ori=None</em>, <em>inversion='single'</em>, <em>weight_norm=None</em>, <em>normalize_fwd=True</em>, <em>real_filter=False</em>, <em>reduce_rank=False</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/mne-tools/mne-python/blob/maint/0.16/mne/../doc/&lt;string&gt;#L968-L1280"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mne.beamformer.tf_dics" title="Permalink to this definition">¶</a></dt>
<dd><p>5D time-frequency beamforming based on DICS.</p>
<p>Calculate source power in time-frequency windows using a spatial filter
based on the Dynamic Imaging of Coherent Sources (DICS) beamforming
approach <a class="reference internal" href="#r24787c541d0a-1" id="id1">[1]</a>. For each time window and frequency bin combination,
cross-spectral density (CSD) is computed and used to create a DICS
beamformer spatial filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epochs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Epochs</span></dt>
<dd><p class="first last">Single trial epochs.</p>
</dd>
<dt><strong>forward</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Forward operator.</p>
</dd>
<dt><strong>noise_csds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of instances of CrossSpectralDensity | None</span></dt>
<dd><p class="first last">Noise cross-spectral density for each frequency bin. If these are
specified, the DICS filters will be applied to both the signal and
noise CSDs. The source power estimates for each frequency bin will be
scaled by the estimated noise power (signal / noise).
Specifying <code class="docutils literal notranslate"><span class="pre">None</span></code> will disable performing noise normalization.</p>
</dd>
<dt><strong>tmin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Minimum time instant to consider.</p>
</dd>
<dt><strong>tmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Maximum time instant to consider.</p>
</dd>
<dt><strong>tstep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Spacing between consecutive time windows, should be smaller than or
equal to the shortest time window length.</p>
</dd>
<dt><strong>win_lengths</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">Time window lengths in seconds. One time window length should be
provided for each frequency bin.</p>
</dd>
<dt><strong>subtract_evoked</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If True, subtract the averaged evoked response prior to computing the
tf source grid. Defaults to False.</p>
</dd>
<dt><strong>mode</strong> <span class="classifier-delimiter">:</span> <span class="classifier">‘fourier’ | ‘multitaper’ | ‘cwt_morlet’</span></dt>
<dd><p class="first last">Spectrum estimation mode. Defaults to ‘fourier’.</p>
</dd>
<dt><strong>freq_bins</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of tuples of float</span></dt>
<dd><p class="first last">Start and end point of frequency bins of interest.
Only used in ‘multitaper’ or ‘fourier’ mode. For ‘cwt_morlet’ mode, use
the <code class="docutils literal notranslate"><span class="pre">frequencies</span></code> parameter instead.</p>
</dd>
<dt><strong>frequencies</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float | list of lists of float</span></dt>
<dd><p class="first last">The frequencies to compute the source power for. If you want to compute
the average power for multiple frequency bins, specify a list of
lists: each list containing the frequencies for the corresponding bin.
Only used in ‘cwt_morlet’ mode. In other modes, use the <code class="docutils literal notranslate"><span class="pre">freq_bins</span></code>
parameter instead.</p>
</dd>
<dt><strong>n_ffts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list | None</span></dt>
<dd><p class="first last">Length of the FFT for each frequency bin. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default),
the exact number of samples between <code class="docutils literal notranslate"><span class="pre">tmin</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code> will be used.
Only used in ‘multitaper’ or ‘fourier’ mode.</p>
</dd>
<dt><strong>mt_bandwidths</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">The bandwidths of the multitaper windowing function in Hz. Only used in
‘multitaper’ mode. One value should be provided for each frequency bin.
Defaults to None.</p>
</dd>
<dt><strong>mt_adaptive</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use adaptive weights to combine the tapered spectra into CSD. Only used
in ‘multitaper’ mode. Defaults to False.</p>
</dd>
<dt><strong>mt_low_bias</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Only use tapers with more than 90% spectral concentration within
bandwidth. Only used in ‘multitaper’ mode. Defaults to True.</p>
</dd>
<dt><strong>cwt_n_cycles: float | list of float | None</strong></dt>
<dd><p class="first last">Number of cycles to use when constructing Morlet wavelets. Fixed number
or one per frequency. Defaults to 7.
Only used in ‘cwt_morlet’ mode.</p>
</dd>
<dt><strong>decim</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int | slice</span></dt>
<dd><p class="first">To reduce memory usage, decimation factor during time-frequency
decomposition. Defaults to 1 (no decimation).
Only used in ‘cwt_morlet’ mode.</p>
<p class="last">If <cite>int</cite>, uses tfr[…, ::decim].
If <cite>slice</cite>, uses tfr[…, decim].</p>
</dd>
<dt><strong>reg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Regularization to use for the DICS beamformer computation.
Defaults to 0.05.</p>
</dd>
<dt><strong>label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Label | None</span></dt>
<dd><p class="first last">Restricts the solution to a given label. Defaults to None.</p>
</dd>
<dt><strong>pick_ori</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | ‘normal’ | ‘max-power’</span></dt>
<dd><p class="first">The source orientation to estimate source power for:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">None</span></code> :</dt>
<dd><p class="first last">orientations are pooled. (Default)</p>
</dd>
<dt>‘normal’ :</dt>
<dd><p class="first last">filters are computed for the orientation tangential to the
cortical surface</p>
</dd>
<dt>‘max-power’ :</dt>
<dd><p class="first last">filters are computer for the orientation that maximizes
spectral power.</p>
</dd>
</dl>
</div></blockquote>
<p class="last">Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>inversion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">‘single’ | ‘matrix’</span></dt>
<dd><p class="first last">This determines how the beamformer deals with source spaces in “free”
orientation. Such source spaces define three orthogonal dipoles at each
source point. When <code class="docutils literal notranslate"><span class="pre">inversion='single'</span></code>, each dipole is considered
as an individual source and the corresponding spatial filter is
computed for each dipole separately. When <code class="docutils literal notranslate"><span class="pre">inversion='matrix'</span></code>, all
three dipoles at a source vertex are considered as a group and the
spatial filters are computed jointly using a matrix inversion. While
<code class="docutils literal notranslate"><span class="pre">inversion='single'</span></code> is more stable, <code class="docutils literal notranslate"><span class="pre">inversion='matrix'</span></code> is more
precise. See section 5 of <a href="#id8"><span class="problematic" id="id2">[4]_</span></a>.  Defaults to ‘single’.</p>
</dd>
<dt><strong>weight_norm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | ‘unit-noise-gain’</span></dt>
<dd><p class="first last">How to normalize the beamformer weights. None means no normalization is
performed.  If ‘unit-noise-gain’, the unit-noise gain minimum variance
beamformer will be computed (Borgiotti-Kaplan beamformer) <a class="reference internal" href="#r24787c541d0a-2" id="id3">[2]</a>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>normalize_fwd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether to normalize the forward solution. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Note
that this normalization is not required when weight normalization
(<code class="docutils literal notranslate"><span class="pre">weight_norm</span></code>) is used.</p>
</dd>
<dt><strong>real_filter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, take only the real part of the cross-spectral-density
matrices to compute real filters. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>reduce_rank</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the rank of the forward operator will be reduced by 1 for
each spatial location, prior to inversion. This may be necessary when
you use a single sphere model for MEG and <code class="docutils literal notranslate"><span class="pre">mode='vertex'</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, str, int, None</span></dt>
<dd><p class="first last">If not None, override default verbose level (see <a class="reference internal" href="mne.verbose.html#mne.verbose" title="mne.verbose"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.verbose()</span></code></a>
and <a class="reference internal" href="../auto_tutorials/plot_configuration.html#tut-logging"><span class="std std-ref">Logging documentation</span></a> for more).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>stcs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of SourceEstimate | VolSourceEstimate</span></dt>
<dd><p class="first last">Source power at each time window. One SourceEstimate object is returned
for each frequency bin.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Dalal et al. <a class="reference internal" href="#r24787c541d0a-1" id="id4">[1]</a> used a synthetic aperture magnetometry beamformer (SAM)
in each time-frequency window instead of DICS.</p>
<p>An alternative to using noise CSDs is to normalize the forward solution
(<code class="docutils literal notranslate"><span class="pre">normalize_fwd</span></code>) or the beamformer weights (<code class="docutils literal notranslate"><span class="pre">weight_norm</span></code>). In
this case, <code class="docutils literal notranslate"><span class="pre">noise_csds</span></code> may be set to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r24787c541d0a-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> Dalal et al. Five-dimensional neuroimaging: Localization of the
time-frequency dynamics of cortical activity.
NeuroImage (2008) vol. 40 (4) pp. 1686-1700</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r24787c541d0a-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> Sekihara &amp; Nagarajan. Adaptive spatial filters for electromagnetic
brain imaging (2008) Springer Science &amp; Business Media</td></tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="examples-using-mne-beamformer-tf-dics">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">mne.beamformer.tf_dics</span></code><a class="headerlink" href="#examples-using-mne-beamformer-tf-dics" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="Compute DICS source power [1]_ in a grid of time-frequency windows and display results."><div class="figure" id="id7">
<img alt="../_images/sphx_glr_plot_tf_dics_thumb.png" src="../_images/sphx_glr_plot_tf_dics_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../auto_examples/inverse/plot_tf_dics.html#sphx-glr-auto-examples-inverse-plot-tf-dics-py"><span class="std std-ref">Time-frequency beamforming using DICS</span></a></span></p>
</div>
</div><div style='clear:both'></div></div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2018, MNE Developers. Last updated on 2018-06-24.</p>
  </div>
</footer>
<script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>