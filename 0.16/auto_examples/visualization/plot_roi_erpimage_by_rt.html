<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Plot single trial activity, grouped by ROI and sorted by RT &#8212; MNE 0.16.1 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  <link rel="canonical" href="https://mne.tools/stable/index.html" />
</head><body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.16.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../getting_started.html">Install</a></li>
                <li><a href="../../documentation.html">Documentation</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.16.1
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.16 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Plot single trial activity, grouped by ROI and sorted by RT</a></li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-visualization-plot-roi-erpimage-by-rt-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="plot-single-trial-activity-grouped-by-roi-and-sorted-by-rt">
<span id="sphx-glr-auto-examples-visualization-plot-roi-erpimage-by-rt-py"></span><h1>Plot single trial activity, grouped by ROI and sorted by RT<a class="headerlink" href="#plot-single-trial-activity-grouped-by-roi-and-sorted-by-rt" title="Permalink to this headline">¶</a></h1>
<p>This will produce what is sometimes called an event related
potential / field (ERP/ERF) image.</p>
<p>The EEGLAB example file - containing an experiment with button press responses
to simple visual stimuli - is read in and response times are calculated.
Regions of Interest are determined by the channel types (in 10/20 channel
notation, even channels are right, odd are left, and ‘z’ are central). The
median and the Global Field Power within each channel group is calculated,
and the trials are plotted, sorting by response time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Jona Sassenhagen &lt;jona.sassenhagen@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">testing</span>
<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="View documentation for mne.Epochs"><span class="n">Epochs</span></a><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <a href="../../generated/mne.pick_types.html#mne.pick_types" title="View documentation for mne.pick_types"><span class="n">pick_types</span></a>
<span class="kn">from</span> <span class="nn">mne.event</span> <span class="kn">import</span> <a href="../../generated/mne.event.define_target_events.html#mne.event.define_target_events" title="View documentation for mne.event.define_target_events"><span class="n">define_target_events</span></a>

<span class="k">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p>Load EEGLAB example data (a small EEG dataset)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">testing</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/EEGLAB/test_raw.set&quot;</span>
<span class="n">montage</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/EEGLAB/test_chans.locs&quot;</span>

<span class="n">event_id</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;square&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  <span class="c1"># must be specified for str events</span>
<span class="n">eog</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;FPz&quot;</span><span class="p">,</span> <span class="s2">&quot;EOG1&quot;</span><span class="p">,</span> <span class="s2">&quot;EOG2&quot;</span><span class="p">}</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_eeglab.html#mne.io.read_raw_eeglab" title="View documentation for mne.io.eeglab.read_raw_eeglab"><span class="n">io</span><span class="o">.</span><span class="n">eeglab</span><span class="o">.</span><span class="n">read_raw_eeglab</span></a><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="n">eog</span><span class="p">,</span> <span class="n">montage</span><span class="o">=</span><span class="n">montage</span><span class="p">,</span>
                                <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">)</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../../generated/mne.pick_types.html#mne.pick_types" title="View documentation for mne.pick_types"><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">events</span> <span class="o">=</span> <a href="../../generated/mne.find_events.html#mne.find_events" title="View documentation for mne.find_events"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Reading /home/circleci/mne_data/MNE-testing-data/EEGLAB/test_raw.fdt
154 events found
Event IDs: [1 2]
</pre></div>
</div>
<p>Create Epochs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define target events:</span>
<span class="c1"># 1. find response times: distance between &quot;square&quot; and &quot;rt&quot; events</span>
<span class="c1"># 2. extract A. &quot;square&quot; events B. followed by a button press within 700 msec</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">7</span>
<span class="n">sfreq</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>
<span class="n">reference_id</span><span class="p">,</span> <span class="n">target_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">new_events</span><span class="p">,</span> <span class="n">rts</span> <span class="o">=</span> <a href="../../generated/mne.event.define_target_events.html#mne.event.define_target_events" title="View documentation for mne.event.define_target_events"><span class="n">define_target_events</span></a><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">reference_id</span><span class="p">,</span> <span class="n">target_id</span><span class="p">,</span> <span class="n">sfreq</span><span class="p">,</span>
                                       <span class="n">tmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span> <span class="n">new_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">epochs</span> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="View documentation for mne.Epochs"><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">new_events</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">event_id</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;square&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>73 matching events found
Applying baseline correction (mode: mean)
Not setting metadata
0 projection items activated
</pre></div>
</div>
<p>Plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters for plotting</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">rts</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>  <span class="c1"># sorting from fast to slow trials</span>

<span class="n">rois</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">pick</span><span class="p">,</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">ch_names</span><span class="p">):</span>
    <span class="n">last_char</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># for 10/20, last letter codes the hemisphere</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Midline&quot;</span> <span class="k">if</span> <span class="n">last_char</span> <span class="ow">in</span> <span class="s2">&quot;z12&quot;</span> <span class="k">else</span>
           <span class="p">(</span><span class="s2">&quot;Left&quot;</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_char</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;Right&quot;</span><span class="p">))</span>
    <span class="n">rois</span><span class="p">[</span><span class="n">roi</span><span class="p">]</span> <span class="o">=</span> <span class="n">rois</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">list</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">pick</span><span class="p">]</span>

<span class="c1"># The actual plots</span>
<span class="k">for</span> <span class="n">combine_measures</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;gfp&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">):</span>
    <span class="n">epochs</span><span class="o">.</span><span class="n">plot_image</span><span class="p">(</span><span class="n">group_by</span><span class="o">=</span><span class="n">rois</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">overlay_times</span><span class="o">=</span><span class="n">rts</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">,</span>
                      <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="n">combine_measures</span><span class="p">,</span>
                      <span class="n">ts_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">vlines</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">rts</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">]))</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_001.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_001.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_002.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_002.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_003.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_003.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_004.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_004.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_005.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_005.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_roi_erpimage_by_rt_006.png" class="sphx-glr-multi-img first" src="../../_images/sphx_glr_plot_roi_erpimage_by_rt_006.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Loading data for 73 events and 129 original time points ...
0 bad epochs dropped
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
Loading data for 73 events and 129 original time points ...
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
73 matching events found
No baseline correction applied
Not setting metadata
0 projection items activated
0 bad epochs dropped
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  2.638 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-visualization-plot-roi-erpimage-by-rt-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_roi_erpimage_by_rt.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_roi_erpimage_by_rt.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_roi_erpimage_by_rt.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_roi_erpimage_by_rt.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2018, MNE Developers. Last updated on 2018-06-24.</p>
  </div>
</footer>
<script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>