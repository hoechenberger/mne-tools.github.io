<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compute point-spread functions (PSFs) for MNE/dSPM/sLORETA &mdash; MNE 0.12.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.0 documentation" href="../../index.html" />
    <link rel="up" title="Examples Gallery" href="../index.html" />
    <link rel="next" title="Generate a functional label from source estimates" href="plot_label_from_stc.html" />
    <link rel="prev" title="Compute LCMV beamformer on evoked data" href="plot_lcmv_beamformer.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  <link rel="canonical" href="https://mne.tools/stable/index.html" />
</head>
  <body role="document">





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../getting_started.html">Get started</a></li>
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../index.html">Gallery</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../manual/index.html">Manual</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribute to MNE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compute point-spread functions (PSFs) for MNE/dSPM/sLORETA</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Compute point-spread functions (PSFs) for MNE/dSPM/sLORETA</a></li>
</ul>

  <li>
    <a href="plot_lcmv_beamformer.html" title="Previous Chapter: Compute LCMV beamformer on evoked data"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Compute LCMV ...</span>
    </a>
  </li>
  <li>
    <a href="plot_label_from_stc.html" title="Next Chapter: Generate a functional label from source estimates"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Generate a fu... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="compute-point-spread-functions-psfs-for-mne-dspm-sloreta">
<span id="sphx-glr-auto-examples-inverse-plot-mne-point-spread-function-py"></span><h1>Compute point-spread functions (PSFs) for MNE/dSPM/sLORETA<a class="headerlink" href="#compute-point-spread-functions-psfs-for-mne-dspm-sloreta" title="Permalink to this headline">Â¶</a></h1>
<p>PSFs are computed for four labels in the MNE sample data set
for linear inverse operators (MNE, dSPM, sLORETA).
PSFs describe the spread of activation from one label
across the cortical surface.</p>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_mne_point_spread_function_001.png"><img alt="../../_images/sphx_glr_plot_mne_point_spread_function_001.png" src="../../_images/sphx_glr_plot_mne_point_spread_function_001.png" style="width: 235.0px; height: 235.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_mne_point_spread_function_002.png"><img alt="../../_images/sphx_glr_plot_mne_point_spread_function_002.png" src="../../_images/sphx_glr_plot_mne_point_spread_function_002.png" style="width: 235.0px; height: 235.0px;" /></a>
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Reading forward solution from /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif...
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
    Desired named matrix (kind = 3523) not available
    Read MEG forward solution (7498 sources, 306 channels, free orientations)
    Desired named matrix (kind = 3523) not available
    Read EEG forward solution (7498 sources, 60 channels, free orientations)
    MEG and EEG forward solutions combined
    Source spaces transformed to the forward solution coordinate frame
    Converting to surface-based source orientations...
    Average patch normals will be employed in the rotation to the local surface coordinates....
[done]
Reading inverse operator decomposition from /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis-meg-eeg-oct-6-meg-eeg-inv.fif...
    Reading inverse operator info...
    [done]
    Reading inverse operator decomposition...
    [done]
    364 x 364 full covariance (kind = 1) found.
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Noise covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 2) found.
    Source covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 6) found.
    Orientation priors read.
    22494 x 22494 diagonal covariance (kind = 5) found.
    Depth priors read.
    Did not find the desired covariance matrix (kind = 3)
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Source spaces transformed to the inverse solution coordinate frame
Reading inverse operator decomposition from /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis-meg-oct-6-meg-inv.fif...
    Reading inverse operator info...
    [done]
    Reading inverse operator decomposition...
    [done]
    305 x 305 full covariance (kind = 1) found.
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Noise covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 2) found.
    Source covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 6) found.
    Orientation priors read.
    22494 x 22494 diagonal covariance (kind = 5) found.
    Depth priors read.
    Did not find the desired covariance matrix (kind = 3)
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Source spaces transformed to the inverse solution coordinate frame
About to process 4 labels
    Converting to surface-based source orientations...
    Average patch normals will be employed in the rotation to the local surface coordinates....
[done]
&lt;Label  |  unknown, u&#39;Aud-rh&#39;, rh : 883 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 1978.94911214  1218.86857762   528.31045019   157.61122813    75.27112997]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 68.5% variance in label.
&lt;Label  |  unknown, u&#39;Aud-lh&#39;, lh : 1097 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 1760.92377927  1439.64644748   743.05280713   156.72701522    80.65306411]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 53.8% variance in label.
&lt;Label  |  unknown, u&#39;Vis-rh&#39;, rh : 623 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 979.45596116  579.38306825  218.70036716   45.46351293   14.07251956]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 71.3% variance in label.
&lt;Label  |  unknown, u&#39;Vis-lh&#39;, lh : 1253 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 1261.76052917   659.9069819    559.49851826    70.12488601    44.44986223]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 67.7% variance in label.
About to apply inverse operator for method=&#39;MNE&#39; and lambda2=0.111111111111
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    Created an SSP operator (subspace dimension = 4)
    Created the whitener using a full noise covariance matrix (4 small eigenvalues omitted)
Picked 364 channels from the data
Computing inverse...
(eigenleads need to be weighted)...
[done]
About to process 4 labels
    Converting to surface-based source orientations...
    Average patch normals will be employed in the rotation to the local surface coordinates....
[done]
&lt;Label  |  unknown, u&#39;Aud-rh&#39;, rh : 883 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 0.00274084  0.00179732  0.00066999  0.00021198  0.00018807]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 66.4% variance in label.
&lt;Label  |  unknown, u&#39;Aud-lh&#39;, lh : 1097 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 0.00223286  0.00095637  0.00044671  0.0002232   0.00012375]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 80.6% variance in label.
&lt;Label  |  unknown, u&#39;Vis-rh&#39;, rh : 623 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [  1.19709958e-03   8.38498995e-04   2.75738170e-04   1.07129273e-04
   9.00191185e-05]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 64.1% variance in label.
&lt;Label  |  unknown, u&#39;Vis-lh&#39;, lh : 1253 vertices&gt;
Computing SVD within labels, using 1 component(s)
First 5 singular values: [ 0.0015879   0.00091905  0.00027931  0.0001392   0.00012593]
(This tells you something about variability of forward solutions in sub-leadfield for label)
Your 1 component(s) explain(s) 72.1% variance in label.
About to apply inverse operator for method=&#39;MNE&#39; and lambda2=0.111111111111
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    Created an SSP operator (subspace dimension = 3)
    Created the whitener using a full noise covariance matrix (3 small eigenvalues omitted)
Picked 305 channels from the data
Computing inverse...
(eigenleads need to be weighted)...
[done]
Updating smoothing matrix, be patient..
Smoothing matrix creation, step 1
Smoothing matrix creation, step 2
Smoothing matrix creation, step 3
Smoothing matrix creation, step 4
Smoothing matrix creation, step 5
Smoothing matrix creation, step 6
Smoothing matrix creation, step 7
Smoothing matrix creation, step 8
Smoothing matrix creation, step 9
Smoothing matrix creation, step 10
colormap: fmin=-3.61e-02 fmid=0.00e+00 fmax=3.61e-02 transparent=0
Updating smoothing matrix, be patient..
Smoothing matrix creation, step 1
Smoothing matrix creation, step 2
Smoothing matrix creation, step 3
Smoothing matrix creation, step 4
Smoothing matrix creation, step 5
Smoothing matrix creation, step 6
Smoothing matrix creation, step 7
Smoothing matrix creation, step 8
Smoothing matrix creation, step 9
Smoothing matrix creation, step 10
colormap: fmin=-2.52e-02 fmid=0.00e+00 fmax=2.52e-02 transparent=0
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Authors: Olaf Hauk &lt;olaf.hauk@mrc-cbu.cam.ac.uk&gt;</span>
<span class="c1">#          Alexandre Gramfort &lt;alexandre.gramfort@telecom-paristech.fr&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <a href="../../generated/mne.minimum_norm.read_inverse_operator.html#mne.minimum_norm.read_inverse_operator"><span class="n">read_inverse_operator</span></a><span class="p">,</span> <a href="../../generated/mne.minimum_norm.point_spread_function.html#mne.minimum_norm.point_spread_function"><span class="n">point_spread_function</span></a>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>

<span class="n">data_path</span> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<span class="n">subjects_dir</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/subjects/&#39;</span>
<span class="n">fname_fwd</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif&#39;</span>
<span class="n">fname_inv_eegmeg</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_path</span> <span class="o">+</span>
                    <span class="s1">&#39;/MEG/sample/sample_audvis-meg-eeg-oct-6-meg-eeg-inv.fif&#39;</span><span class="p">)</span>
<span class="n">fname_inv_meg</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis-meg-oct-6-meg-inv.fif&#39;</span>
<span class="n">fname_label</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/labels/Aud-rh.label&#39;</span><span class="p">,</span>
               <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/labels/Aud-lh.label&#39;</span><span class="p">,</span>
               <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/labels/Vis-rh.label&#39;</span><span class="p">,</span>
               <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/labels/Vis-lh.label&#39;</span><span class="p">]</span>


<span class="c1"># read forward solution</span>
<span class="n">forward</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_forward_solution</span><span class="p">(</span><span class="n">fname_fwd</span><span class="p">,</span> <span class="n">force_fixed</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                    <span class="n">surf_ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># read inverse operators</span>
<span class="n">inverse_operator_eegmeg</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.read_inverse_operator.html#mne.minimum_norm.read_inverse_operator"><span class="n">read_inverse_operator</span></a><span class="p">(</span><span class="n">fname_inv_eegmeg</span><span class="p">)</span>
<span class="n">inverse_operator_meg</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.read_inverse_operator.html#mne.minimum_norm.read_inverse_operator"><span class="n">read_inverse_operator</span></a><span class="p">(</span><span class="n">fname_inv_meg</span><span class="p">)</span>

<span class="c1"># read label(s)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><a href="../../generated/mne.read_label.html#mne.read_label"><span class="n">mne</span><span class="o">.</span><span class="n">read_label</span></a><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">fname_label</span><span class="p">]</span>

<span class="c1"># regularisation parameter</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">snr</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;MNE&#39;</span>  <span class="c1"># can be &#39;MNE&#39; or &#39;sLORETA&#39;</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;svd&#39;</span>
<span class="n">n_svd_comp</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">stc_psf_eegmeg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.point_spread_function.html#mne.minimum_norm.point_spread_function"><span class="n">point_spread_function</span></a><span class="p">(</span>
    <span class="n">inverse_operator_eegmeg</span><span class="p">,</span> <span class="n">forward</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">n_svd_comp</span><span class="o">=</span><span class="n">n_svd_comp</span><span class="p">)</span>

<span class="n">stc_psf_meg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.point_spread_function.html#mne.minimum_norm.point_spread_function"><span class="n">point_spread_function</span></a><span class="p">(</span>
    <span class="n">inverse_operator_meg</span><span class="p">,</span> <span class="n">forward</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">n_svd_comp</span><span class="o">=</span><span class="n">n_svd_comp</span><span class="p">)</span>

<span class="c1"># save for viewing in mne_analyze in order of labels in &#39;labels&#39;</span>
<span class="c1"># last sample is average across PSFs</span>
<span class="c1"># stc_psf_eegmeg.save(&#39;psf_eegmeg&#39;)</span>
<span class="c1"># stc_psf_meg.save(&#39;psf_meg&#39;)</span>

<span class="n">time_label</span> <span class="o">=</span> <span class="s2">&quot;EEGMEG </span><span class="si">%d</span><span class="s2">&quot;</span>
<span class="n">brain_eegmeg</span> <span class="o">=</span> <span class="n">stc_psf_eegmeg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">,</span>
                                   <span class="n">time_label</span><span class="o">=</span><span class="n">time_label</span><span class="p">,</span>
                                   <span class="n">figure</span><span class="o">=</span><a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_figure.html#mayavi.mlab.figure"><span class="n">mlab</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)))</span>

<span class="n">time_label</span> <span class="o">=</span> <span class="s2">&quot;MEG </span><span class="si">%d</span><span class="s2">&quot;</span>
<span class="n">brain_meg</span> <span class="o">=</span> <span class="n">stc_psf_meg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">,</span>
                             <span class="n">time_label</span><span class="o">=</span><span class="n">time_label</span><span class="p">,</span>
                             <span class="n">figure</span><span class="o">=</span><a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_figure.html#mayavi.mlab.figure"><span class="n">mlab</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)))</span>

<span class="c1"># The PSF is centred around the right auditory cortex label,</span>
<span class="c1"># but clearly extends beyond it.</span>
<span class="c1"># It also contains &quot;sidelobes&quot; or &quot;ghost sources&quot;</span>
<span class="c1"># in middle/superior temporal lobe.</span>
<span class="c1"># For the Aud-RH example, MEG and EEGMEG do not seem to differ a lot,</span>
<span class="c1"># but the addition of EEG still decreases point-spread to distant areas</span>
<span class="c1"># (e.g. to ATL and IFG).</span>
<span class="c1"># The chosen labels are quite far apart from each other, so their PSFs</span>
<span class="c1"># do not overlap (check in mne_analyze)</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong>
(0 minutes 22.009 seconds)</p>
<div class="sphx-glr-download container">
<strong>Download Python source code:</strong> <a class="reference download internal" href="../../_downloads/plot_mne_point_spread_function.py"><code class="xref download docutils literal"><span class="pre">plot_mne_point_spread_function.py</span></code></a></div>
<div class="sphx-glr-download container">
<strong>Download IPython notebook:</strong> <a class="reference download internal" href="../../_downloads/plot_mne_point_spread_function.ipynb"><code class="xref download docutils literal"><span class="pre">plot_mne_point_spread_function.ipynb</span></code></a></div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers. Last updated on 2016-05-10.<br/>
    </p>
  </div>
</footer>
<script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>