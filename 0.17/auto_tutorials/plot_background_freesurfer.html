<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FreeSurfer integration with MNE-Python &#8212; MNE 0.17.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/reset-syntax.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  <link rel="canonical" href="https://mne.tools/stable/index.html" />
</head><body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.17.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Install</a></li>
                <li><a href="../documentation.html">Documentation</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.17.1
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.17 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">FreeSurfer integration with MNE-Python</a><ul>
<li><a class="reference internal" href="#first-steps">First steps</a></li>
<li><a class="reference internal" href="#anatomical-reconstruction">Anatomical reconstruction</a></li>
<li><a class="reference internal" href="#fsaverage">‘fsaverage’</a></li>
<li><a class="reference internal" href="#use-with-mne-python">Use with MNE-Python</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-background-freesurfer-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="freesurfer-integration-with-mne-python">
<span id="sphx-glr-auto-tutorials-plot-background-freesurfer-py"></span><h1>FreeSurfer integration with MNE-Python<a class="headerlink" href="#freesurfer-integration-with-mne-python" title="Permalink to this headline">¶</a></h1>
<p>FreeSurfer is an open source analysis toolbox for MRI data. It contains several
command line tools and graphical user interfaces. FreeSurfer can be obtained
from <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/">https://surfer.nmr.mgh.harvard.edu/</a></p>
<p>In MNE, FreeSurfer is used to provide structural information of various
kinds, for <a class="reference internal" href="plot_mne_dspm_source_localization.html#sphx-glr-auto-tutorials-plot-mne-dspm-source-localization-py"><span class="std std-ref">source estimation</span></a>. Thereby a
subject specific structural MRI will be used to obtain various structural
representations like spherical or inflated brain surfaces. Furthermore features
like curvature as well as various labels for areas of interest (such as V1) are
computed.</p>
<p>Thus FreeSurfer provides an easy way to shift anatomically related
data between different representations and spaces. See e.g.
<a class="reference internal" href="plot_morph_stc.html#sphx-glr-auto-tutorials-plot-morph-stc-py"><span class="std std-ref">Morphing source estimates: Moving data from one brain to another</span></a> for information about how to
use FreeSurfer surface representations to allow functional data to morph
between different subjects.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#first-steps" id="id2">First steps</a></li>
<li><a class="reference internal" href="#anatomical-reconstruction" id="id3">Anatomical reconstruction</a></li>
<li><a class="reference internal" href="#fsaverage" id="id4">‘fsaverage’</a></li>
<li><a class="reference internal" href="#use-with-mne-python" id="id5">Use with MNE-Python</a></li>
</ul>
</div>
<div class="section" id="first-steps">
<h2><a class="toc-backref" href="#id2">First steps</a><a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<p>After downloading and installing, the environment needs to be set up correctly.
This can be done by setting the FreeSurfer’s root directory correctly and
sourcing the setup file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export FREESURFER_HOME=/path/to/FreeSurfer
$ source $FREESURFER_HOME/SetUpFreeSurfer.sh
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The FreeSurfer home directory might vary depending on your operating
system. See the <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/DownloadAndInstall">FreeSurfer installation guide</a> for more.</p>
</div>
<p>Another important step is to define the subject directory correctly.
<code class="docutils literal notranslate"><span class="pre">SUBJECTS_DIR</span></code> must be defined such, that it contains the individual
subject’s reconstructions in separate sub-folders. Those sub-folders will be
created upon the reconstruction of the anatomical data. Nevertheless the parent
directory has to be set beforehand:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export SUBJECTS_DIR=~/subjects
</pre></div>
</div>
<p>Again see the <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/DownloadAndInstall">FreeSurfer installation guide</a> for more.</p>
<p>Once setup correctly, FreeSurfer will create a new subject folder in
<code class="docutils literal notranslate"><span class="pre">$SUBJECTS_DIR</span></code>.</p>
</div>
<div class="section" id="anatomical-reconstruction">
<h2><a class="toc-backref" href="#id3">Anatomical reconstruction</a><a class="headerlink" href="#anatomical-reconstruction" title="Permalink to this headline">¶</a></h2>
<p>MNE-Python works together with FreeSurfer in order to compute the forward model
and setting up the corresponding <a class="reference internal" href="../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces"><code class="xref py py-class docutils literal notranslate"><span class="pre">source</span> <span class="pre">space</span></code></a>. See
<a class="reference internal" href="../manual/cookbook.html#setting-up-source-space"><span class="std std-ref">Setting up the source space</span></a> for more information. Usually a full FreeSurfer
reconstruction is obtained by prompting the following command to a bash
console (e.g. Linux or MacOS Terminal):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ my_subject=sample
$ my_NIfTI=/path/to/NIfTI.nii.gz
$ recon-all -i $my_NIfTI -s $my_subject -all
</pre></div>
</div>
<p>, where <span class="math notranslate nohighlight">\(i\)</span> stands for “input” and <span class="math notranslate nohighlight">\(s\)</span> for “subject”. Executing
this, will create the folder “~/subjects/sample”, where all
results are stored.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This compution takes often several hours. Please be patient.</p>
</div>
<p>Within a single subject all the files MNE-Python uses (and some more) are
grouped into meaningful sub-folders (such that “surf” contains surface
representations, “mri” volumetric files, etc.).</p>
<p>FreeSurfer performs a hemispheric separation and most results are present
in a left and right hemisphere version. This is often indicated by the
prefix <code class="docutils literal notranslate"><span class="pre">lh</span></code> or <code class="docutils literal notranslate"><span class="pre">rh</span></code> to refer to the aforementioned. For that reason
data representations such as <a class="reference internal" href="../generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.SourceEstimate</span></code></a> carry two sets of
spatial locations (vertices) for both hemispheres separately. See also
<a class="reference internal" href="plot_object_source_estimate.html#sphx-glr-auto-tutorials-plot-object-source-estimate-py"><span class="std std-ref">The SourceEstimate data structure</span></a>.</p>
</div>
<div class="section" id="fsaverage">
<h2><a class="toc-backref" href="#id4">‘fsaverage’</a><a class="headerlink" href="#fsaverage" title="Permalink to this headline">¶</a></h2>
<p>During installation, FreeSurfer copies a “default” subject, called
<code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> to <code class="docutils literal notranslate"><span class="pre">$FREESURFER_HOME/subjects/fsaverage</span></code>. It contains all
data types that a subject reconstruction would yield and is required by
MNE-Python.</p>
<p>See <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/FsAverage">https://surfer.nmr.mgh.harvard.edu/fswiki/FsAverage</a> for more
information. Furthermore a copy of ‘fsaverage’ can be found in
<a class="reference internal" href="../manual/sample_dataset.html#ch-sample-data"><span class="std std-ref">The sample data set</span></a>.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> as value for the definition
of a subject when calling a function, the corresponding data will be read (e.g.
<code class="docutils literal notranslate"><span class="pre">subject='fsaverage'</span></code>) from ‘~/subjects/fsaverage’. This becomes especially
handy, when attempting statistical analyses on group level, based on
individual’s brain space data. In that case <code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> will by default act
as reference space for <a class="reference internal" href="plot_morph_stc.html#sphx-glr-auto-tutorials-plot-morph-stc-py"><span class="std std-ref">source estimate transformations</span></a>.</p>
</div>
<div class="section" id="use-with-mne-python">
<h2><a class="toc-backref" href="#id5">Use with MNE-Python</a><a class="headerlink" href="#use-with-mne-python" title="Permalink to this headline">¶</a></h2>
<p>For source localization analyses to work properly, it is important, that the
FreeSurfer reconstruction has completed beforehand. Furthermore, when using
related functions, such as <a class="reference internal" href="../generated/mne.setup_source_space.html#mne.setup_source_space" title="mne.setup_source_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.setup_source_space()</span></code></a>, <code class="docutils literal notranslate"><span class="pre">SUBJECTS_DIR</span></code> has
to be defined either globally by setting <a class="reference internal" href="../generated/mne.set_config.html#mne.set_config" title="mne.set_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.set_config()</span></code></a> or for
each function separately, by passing the respective keyword argument
<code class="docutils literal notranslate"><span class="pre">subjects_dir='~/subjects'</span></code>. See also <a class="reference internal" href="../manual/cookbook.html#setting-up-source-space"><span class="std std-ref">Setting up the source space</span></a> to get
an idea of how this works.</p>
<p><strong>Estimated memory usage:</strong>  10 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-background-freesurfer-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/77f4a389794170e81a2269a8804221b1/plot_background_freesurfer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_background_freesurfer.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/b9baa25ecaa718ede2428661fabcc772/plot_background_freesurfer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_background_freesurfer.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2019, MNE Developers. Last updated on 2019-02-22.</p>
  </div>
</footer>
<script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>