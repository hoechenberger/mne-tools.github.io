<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Extracting and visualizing subject head movement &#8212; MNE 0.23.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />


    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="d-block devbar alert alert-danger">
This is documentation for the <em>unstable development version</em> of MNE-Python,
<a href="https://mne.tools/dev/install/advanced.html#using-the-development-version-of-mne-python-latest-main">available here</a>.
Or, switch to documentation for the <a href="https://mne.tools/stable">current stable version</a>.

</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.svg"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.23.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
            
            
            <li class="dropdown globaltoc-container">
              <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">More<b class="caret"></b></a>
              <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc">
                <li><a href="https://github.com/mne-tools/mne-python"><i class="fa fa-github"></i> GitHub</a></li>
                <li><a href="../../overview/get_help.html"><i class="fa fa-question-circle"></i> Get help</a></li>
                <li><a href="../../install/contributing.html"><i class="fa fa-code-fork"></i> Contribute</a></li>
                <li><a href="../../overview/cite.html"><i class="fa fa-book"></i> Cite MNE</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.23.dev0
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
                <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-preprocessing-plot-59-head-positions-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="extracting-and-visualizing-subject-head-movement">
<span id="tut-head-pos"></span><span id="sphx-glr-auto-tutorials-preprocessing-plot-59-head-positions-py"></span><h1>Extracting and visualizing subject head movement<a class="headerlink" href="#extracting-and-visualizing-subject-head-movement" title="Permalink to this headline">¶</a></h1>
<p>Continuous head movement can be encoded during MEG recordings by use of
HPI coils that continuously emit sinusoidal signals. These signals can then be
extracted from the recording and used to estimate head position as a function
of time. Here we show an example of how to do this, and how to visualize
the result.</p>
<div class="section" id="hpi-frequencies">
<h2>HPI frequencies<a class="headerlink" href="#hpi-frequencies" title="Permalink to this headline">¶</a></h2>
<p>First let’s load a short bit of raw data where the subject intentionally moved
their head during the recording. Its power spectral density shows five peaks
(most clearly visible in the gradiometers) corresponding to the HPI coil
frequencies, plus other peaks related to power line interference (60 Hz and
harmonics).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">op</span>

<span class="kn">import</span> <span class="nn">mne</span>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="s1">&#39;SSS&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;test_move_anon_raw.fif&#39;</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a><span class="p">,</span> <span class="n">allow_maxshield</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_psd" title="mne.io.Raw.plot_psd" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">plot_psd</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="EEG, Gradiometers, Magnetometers" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-testing-data/SSS/test_move_anon_raw.fif...
    Read a total of 12 projection items:
        mag.fif : PCA-v1 (1 x 306)  idle
        mag.fif : PCA-v2 (1 x 306)  idle
        mag.fif : PCA-v3 (1 x 306)  idle
        mag.fif : PCA-v4 (1 x 306)  idle
        mag.fif : PCA-v5 (1 x 306)  idle
        mag.fif : PCA-v6 (1 x 306)  idle
        mag.fif : PCA-v7 (1 x 306)  idle
        grad.fif : PCA-v1 (1 x 306)  idle
        grad.fif : PCA-v2 (1 x 306)  idle
        grad.fif : PCA-v3 (1 x 306)  idle
        grad.fif : PCA-v4 (1 x 306)  idle
        Average EEG reference (1 x 60)  idle
    Range : 10800 ... 31199 =      9.000 ...    25.999 secs
Ready.
Reading 0 ... 20399  =      0.000 ...    16.999 secs...
Effective window size : 1.707 (s)
Effective window size : 1.707 (s)
Effective window size : 1.707 (s)
</pre></div>
</div>
</div>
<div class="section" id="estimating-continuous-head-position">
<h2>Estimating continuous head position<a class="headerlink" href="#estimating-continuous-head-position" title="Permalink to this headline">¶</a></h2>
<p>First, let’s extract the HPI coil amplitudes as a function of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_amplitudes</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_chpi_amplitudes.html#mne.chpi.compute_chpi_amplitudes" title="mne.chpi.compute_chpi_amplitudes" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_chpi_amplitudes</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using 5 HPI coils: 83 143 203 263 323 Hz
Line interference frequencies: 60 120 180 240 300 360 Hz
Using time window: 83.3 ms
Fitting 5 HPI coil locations at up to 1696 time points (17.0 sec duration)

  0%|          | cHPI amplitudes : 0/1696 [00:00&lt;?,       ?it/s]
  0%|          | cHPI amplitudes : 1/1696 [00:04&lt;1:58:56,    4.21s/it]
  1%|1         | cHPI amplitudes : 19/1696 [00:04&lt;05:55,    4.72it/s]
  1%|1         | cHPI amplitudes : 25/1696 [00:04&lt;04:26,    6.26it/s]
  2%|1         | cHPI amplitudes : 33/1696 [00:04&lt;03:17,    8.42it/s]
  2%|2         | cHPI amplitudes : 38/1696 [00:04&lt;02:48,    9.81it/s]
  3%|2         | cHPI amplitudes : 50/1696 [00:04&lt;02:03,   13.36it/s]
  4%|4         | cHPI amplitudes : 70/1696 [00:04&lt;01:23,   19.58it/s]
  5%|5         | cHPI amplitudes : 90/1696 [00:04&lt;01:01,   26.05it/s]
  6%|5         | cHPI amplitudes : 99/1696 [00:04&lt;00:55,   29.00it/s]
  6%|6         | cHPI amplitudes : 106/1696 [00:04&lt;00:50,   31.34it/s]
  7%|6         | cHPI amplitudes : 113/1696 [00:04&lt;00:46,   33.78it/s]
  7%|7         | cHPI amplitudes : 127/1696 [00:04&lt;00:40,   39.08it/s]
  9%|8         | cHPI amplitudes : 150/1696 [00:04&lt;00:32,   48.29it/s]
 10%|#         | cHPI amplitudes : 172/1696 [00:04&lt;00:26,   57.42it/s]
 11%|#         | cHPI amplitudes : 181/1696 [00:04&lt;00:24,   61.04it/s]
 11%|#1        | cHPI amplitudes : 188/1696 [00:04&lt;00:23,   63.84it/s]
 11%|#1        | cHPI amplitudes : 195/1696 [00:04&lt;00:22,   66.72it/s]
 12%|#2        | cHPI amplitudes : 209/1696 [00:04&lt;00:20,   73.33it/s]
 14%|#3        | cHPI amplitudes : 230/1696 [00:04&lt;00:17,   83.89it/s]
 15%|#4        | cHPI amplitudes : 250/1696 [00:04&lt;00:15,   94.24it/s]
 15%|#5        | cHPI amplitudes : 260/1696 [00:04&lt;00:14,   99.07it/s]
 16%|#5        | cHPI amplitudes : 267/1696 [00:04&lt;00:13,  102.29it/s]
 16%|#6        | cHPI amplitudes : 274/1696 [00:04&lt;00:13,  105.63it/s]
 17%|#6        | cHPI amplitudes : 286/1696 [00:04&lt;00:12,  112.36it/s]
 18%|#8        | cHPI amplitudes : 308/1696 [00:04&lt;00:11,  126.10it/s]
 19%|#9        | cHPI amplitudes : 328/1696 [00:04&lt;00:09,  138.81it/s]
 20%|#9        | cHPI amplitudes : 337/1696 [00:04&lt;00:09,  143.60it/s]
 20%|##        | cHPI amplitudes : 344/1696 [00:04&lt;00:09,  147.06it/s]
 21%|##        | cHPI amplitudes : 351/1696 [00:04&lt;00:08,  150.59it/s]
 22%|##1       | cHPI amplitudes : 366/1696 [00:04&lt;00:08,  160.87it/s]
 23%|##2       | cHPI amplitudes : 384/1696 [00:04&lt;00:07,  174.05it/s]
 24%|##3       | cHPI amplitudes : 401/1696 [00:04&lt;00:06,  186.53it/s]
 24%|##4       | cHPI amplitudes : 409/1696 [00:04&lt;00:06,  190.74it/s]
 25%|##4       | cHPI amplitudes : 416/1696 [00:04&lt;00:06,  194.19it/s]
 25%|##4       | cHPI amplitudes : 423/1696 [00:04&lt;00:06,  197.79it/s]
 26%|##5       | cHPI amplitudes : 440/1696 [00:04&lt;00:05,  211.88it/s]
 27%|##7       | cHPI amplitudes : 459/1696 [00:04&lt;00:05,  228.16it/s]
 28%|##7       | cHPI amplitudes : 474/1696 [00:04&lt;00:05,  240.41it/s]
 28%|##8       | cHPI amplitudes : 481/1696 [00:04&lt;00:04,  243.75it/s]
 29%|##8       | cHPI amplitudes : 488/1696 [00:04&lt;00:04,  247.01it/s]
 29%|##9       | cHPI amplitudes : 495/1696 [00:04&lt;00:04,  250.30it/s]
 30%|###       | cHPI amplitudes : 511/1696 [00:04&lt;00:04,  265.09it/s]
 31%|###1      | cHPI amplitudes : 529/1696 [00:04&lt;00:04,  282.43it/s]
 32%|###2      | cHPI amplitudes : 545/1696 [00:04&lt;00:03,  296.76it/s]
 33%|###2      | cHPI amplitudes : 552/1696 [00:04&lt;00:03,  299.41it/s]
 33%|###2      | cHPI amplitudes : 559/1696 [00:04&lt;00:03,  301.92it/s]
 33%|###3      | cHPI amplitudes : 567/1696 [00:04&lt;00:03,  306.38it/s]
 34%|###4      | cHPI amplitudes : 583/1696 [00:05&lt;00:03,  322.39it/s]
 35%|###5      | cHPI amplitudes : 600/1696 [00:05&lt;00:03,  339.99it/s]
 36%|###6      | cHPI amplitudes : 614/1696 [00:05&lt;00:03,  352.34it/s]
 37%|###6      | cHPI amplitudes : 622/1696 [00:05&lt;00:03,  354.93it/s]
 37%|###7      | cHPI amplitudes : 629/1696 [00:05&lt;00:02,  356.26it/s]
 38%|###7      | cHPI amplitudes : 636/1696 [00:05&lt;00:02,  358.13it/s]
 39%|###8      | cHPI amplitudes : 655/1696 [00:05&lt;00:02,  380.10it/s]
 40%|###9      | cHPI amplitudes : 670/1696 [00:05&lt;00:02,  395.19it/s]
 40%|####      | cHPI amplitudes : 681/1696 [00:05&lt;00:02,  403.29it/s]
 41%|####      | cHPI amplitudes : 688/1696 [00:05&lt;00:02,  403.58it/s]
 41%|####      | cHPI amplitudes : 695/1696 [00:05&lt;00:02,  403.93it/s]
 42%|####1     | cHPI amplitudes : 704/1696 [00:05&lt;00:02,  407.99it/s]
 43%|####2     | cHPI amplitudes : 726/1696 [00:05&lt;00:02,  437.39it/s]
 44%|####3     | cHPI amplitudes : 743/1696 [00:05&lt;00:02,  456.66it/s]
 45%|####4     | cHPI amplitudes : 757/1696 [00:05&lt;00:02,  469.32it/s]
 45%|####5     | cHPI amplitudes : 765/1696 [00:05&lt;00:01,  468.12it/s]
 46%|####5     | cHPI amplitudes : 773/1696 [00:05&lt;00:01,  467.38it/s]
 46%|####5     | cHPI amplitudes : 780/1696 [00:05&lt;00:01,  466.27it/s]
 47%|####6     | cHPI amplitudes : 796/1696 [00:05&lt;00:01,  483.59it/s]
 48%|####8     | cHPI amplitudes : 815/1696 [00:05&lt;00:01,  506.95it/s]
 49%|####8     | cHPI amplitudes : 827/1696 [00:05&lt;00:01,  513.94it/s]
 49%|####9     | cHPI amplitudes : 834/1696 [00:05&lt;00:01,  509.27it/s]
 50%|####9     | cHPI amplitudes : 841/1696 [00:05&lt;00:01,  505.08it/s]
 50%|#####     | cHPI amplitudes : 851/1696 [00:05&lt;00:01,  508.74it/s]
 51%|#####1    | cHPI amplitudes : 871/1696 [00:05&lt;00:01,  535.22it/s]
 52%|#####2    | cHPI amplitudes : 889/1696 [00:05&lt;00:01,  556.73it/s]
 53%|#####3    | cHPI amplitudes : 901/1696 [00:05&lt;00:01,  562.92it/s]
 54%|#####3    | cHPI amplitudes : 908/1696 [00:05&lt;00:01,  557.89it/s]
 54%|#####3    | cHPI amplitudes : 915/1696 [00:05&lt;00:01,  551.21it/s]
 55%|#####4    | cHPI amplitudes : 925/1696 [00:05&lt;00:01,  553.59it/s]
 56%|#####5    | cHPI amplitudes : 943/1696 [00:05&lt;00:01,  574.81it/s]
 57%|#####6    | cHPI amplitudes : 962/1696 [00:05&lt;00:01,  598.14it/s]
 57%|#####7    | cHPI amplitudes : 974/1696 [00:05&lt;00:01,  601.36it/s]
 58%|#####7    | cHPI amplitudes : 981/1696 [00:05&lt;00:01,  594.06it/s]
 58%|#####8    | cHPI amplitudes : 988/1696 [00:05&lt;00:01,  586.46it/s]
 59%|#####8    | cHPI amplitudes : 997/1696 [00:05&lt;00:01,  584.57it/s]
 60%|#####9    | cHPI amplitudes : 1012/1696 [00:05&lt;00:01,  597.90it/s]
 61%|######    | cHPI amplitudes : 1031/1696 [00:05&lt;00:01,  621.02it/s]
 61%|######1   | cHPI amplitudes : 1042/1696 [00:05&lt;00:01,  622.99it/s]
 62%|######1   | cHPI amplitudes : 1049/1696 [00:05&lt;00:01,  613.53it/s]
 62%|######2   | cHPI amplitudes : 1056/1696 [00:05&lt;00:01,  603.38it/s]
 63%|######2   | cHPI amplitudes : 1066/1696 [00:05&lt;00:01,  603.23it/s]
 64%|######3   | cHPI amplitudes : 1084/1696 [00:05&lt;00:00,  625.35it/s]
 65%|######5   | cHPI amplitudes : 1104/1696 [00:05&lt;00:00,  651.24it/s]
 66%|######5   | cHPI amplitudes : 1114/1696 [00:05&lt;00:00,  650.07it/s]
 66%|######6   | cHPI amplitudes : 1121/1696 [00:05&lt;00:00,  640.00it/s]
 67%|######6   | cHPI amplitudes : 1128/1696 [00:05&lt;00:00,  627.65it/s]
 67%|######7   | cHPI amplitudes : 1137/1696 [00:05&lt;00:00,  624.26it/s]
 68%|######8   | cHPI amplitudes : 1156/1696 [00:05&lt;00:00,  647.06it/s]
 69%|######9   | cHPI amplitudes : 1172/1696 [00:05&lt;00:00,  661.90it/s]
 70%|######9   | cHPI amplitudes : 1179/1696 [00:05&lt;00:00,  651.81it/s]
 70%|######9   | cHPI amplitudes : 1186/1696 [00:05&lt;00:00,  641.69it/s]
 70%|#######   | cHPI amplitudes : 1193/1696 [00:05&lt;00:00,  630.04it/s]
 71%|#######   | cHPI amplitudes : 1203/1696 [00:05&lt;00:00,  628.22it/s]
 72%|#######1  | cHPI amplitudes : 1221/1696 [00:05&lt;00:00,  649.71it/s]
 73%|#######3  | cHPI amplitudes : 1240/1696 [00:05&lt;00:00,  672.18it/s]
 74%|#######3  | cHPI amplitudes : 1250/1696 [00:05&lt;00:00,  666.60it/s]
 74%|#######4  | cHPI amplitudes : 1257/1696 [00:05&lt;00:00,  655.68it/s]
 74%|#######4  | cHPI amplitudes : 1263/1696 [00:05&lt;00:00,  642.25it/s]
 75%|#######5  | cHPI amplitudes : 1272/1696 [00:05&lt;00:00,  637.32it/s]
 76%|#######6  | cHPI amplitudes : 1293/1696 [00:06&lt;00:00,  667.91it/s]
 77%|#######7  | cHPI amplitudes : 1314/1696 [00:06&lt;00:00,  696.43it/s]
 78%|#######8  | cHPI amplitudes : 1324/1696 [00:06&lt;00:00,  689.29it/s]
 78%|#######8  | cHPI amplitudes : 1330/1696 [00:06&lt;00:00,  674.08it/s]
 79%|#######8  | cHPI amplitudes : 1337/1696 [00:06&lt;00:00,  658.70it/s]
 80%|#######9  | cHPI amplitudes : 1352/1696 [00:06&lt;00:00,  670.02it/s]
 81%|########1 | cHPI amplitudes : 1374/1696 [00:06&lt;00:00,  701.23it/s]
 82%|########2 | cHPI amplitudes : 1393/1696 [00:06&lt;00:00,  723.28it/s]
 83%|########2 | cHPI amplitudes : 1401/1696 [00:06&lt;00:00,  707.84it/s]
 83%|########3 | cHPI amplitudes : 1408/1696 [00:06&lt;00:00,  693.23it/s]
 83%|########3 | cHPI amplitudes : 1415/1696 [00:06&lt;00:00,  678.44it/s]
 84%|########4 | cHPI amplitudes : 1427/1696 [00:06&lt;00:00,  681.06it/s]
 85%|########5 | cHPI amplitudes : 1442/1696 [00:06&lt;00:00,  692.49it/s]
 86%|########6 | cHPI amplitudes : 1459/1696 [00:06&lt;00:00,  708.60it/s]
 86%|########6 | cHPI amplitudes : 1466/1696 [00:06&lt;00:00,  694.07it/s]
 87%|########6 | cHPI amplitudes : 1473/1696 [00:06&lt;00:00,  679.47it/s]
 87%|########7 | cHPI amplitudes : 1480/1696 [00:06&lt;00:00,  664.50it/s]
 88%|########8 | cHPI amplitudes : 1496/1696 [00:06&lt;00:00,  680.02it/s]
 89%|########9 | cHPI amplitudes : 1514/1696 [00:06&lt;00:00,  699.65it/s]
 90%|######### | cHPI amplitudes : 1532/1696 [00:06&lt;00:00,  718.67it/s]
 91%|######### | cHPI amplitudes : 1539/1696 [00:06&lt;00:00,  702.81it/s]
 91%|#########1| cHPI amplitudes : 1546/1696 [00:06&lt;00:00,  687.55it/s]
 92%|#########1| cHPI amplitudes : 1553/1696 [00:06&lt;00:00,  675.82it/s]
 93%|#########2| cHPI amplitudes : 1570/1696 [00:06&lt;00:00,  693.28it/s]
 94%|#########3| cHPI amplitudes : 1587/1696 [00:06&lt;00:00,  710.50it/s]
 95%|#########4| cHPI amplitudes : 1605/1696 [00:06&lt;00:00,  729.31it/s]
 95%|#########5| cHPI amplitudes : 1613/1696 [00:06&lt;00:00,  714.41it/s]
 96%|#########5| cHPI amplitudes : 1620/1696 [00:06&lt;00:00,  696.56it/s]
 96%|#########5| cHPI amplitudes : 1627/1696 [00:06&lt;00:00,  680.49it/s]
 97%|#########7| cHPI amplitudes : 1646/1696 [00:06&lt;00:00,  702.84it/s]
 98%|#########8| cHPI amplitudes : 1667/1696 [00:06&lt;00:00,  730.79it/s]
 99%|#########9| cHPI amplitudes : 1681/1696 [00:06&lt;00:00,  734.02it/s]
100%|#########9| cHPI amplitudes : 1688/1696 [00:06&lt;00:00,  716.82it/s]
100%|#########9| cHPI amplitudes : 1694/1696 [00:06&lt;00:00,  698.00it/s]
100%|##########| cHPI amplitudes : 1696/1696 [00:06&lt;00:00,  257.82it/s]
</pre></div>
</div>
<p>Second, let’s compute time-varying HPI coil locations from these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_locs</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_chpi_locs.html#mne.chpi.compute_chpi_locs" title="mne.chpi.compute_chpi_locs" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_chpi_locs</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_amplitudes</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing 4385 HPI location guesses (1 cm grid in a 10.7 cm sphere)
HPIFIT: 5 coils digitized in order 5 1 4 3 2
HPI consistency of isotrak and hpifit is OK.

  0%|          | cHPI locations  : 0/1696 [00:00&lt;?,       ?it/s]
  0%|          | cHPI locations  : 1/1696 [00:00&lt;26:30,    1.07it/s]
  2%|1         | cHPI locations  : 33/1696 [00:00&lt;00:45,   36.30it/s]
  4%|3         | cHPI locations  : 67/1696 [00:00&lt;00:21,   74.31it/s]
  5%|5         | cHPI locations  : 87/1696 [00:00&lt;00:16,   96.40it/s]
  6%|5         | cHPI locations  : 101/1696 [00:01&lt;00:15,  100.04it/s]
  7%|7         | cHPI locations  : 120/1696 [00:01&lt;00:13,  119.59it/s]
  8%|8         | cHPI locations  : 140/1696 [00:01&lt;00:11,  140.48it/s]
 10%|#         | cHPI locations  : 170/1696 [00:01&lt;00:08,  173.69it/s]
 12%|#1        | cHPI locations  : 201/1696 [00:01&lt;00:08,  186.00it/s]
 13%|#3        | cHPI locations  : 222/1696 [00:01&lt;00:07,  206.43it/s]
 14%|#4        | cHPI locations  : 240/1696 [00:01&lt;00:06,  223.64it/s]
 15%|#5        | cHPI locations  : 258/1696 [00:01&lt;00:05,  240.99it/s]
 16%|#6        | cHPI locations  : 275/1696 [00:01&lt;00:05,  257.39it/s]
 17%|#7        | cHPI locations  : 296/1696 [00:01&lt;00:05,  279.10it/s]
 18%|#7        | cHPI locations  : 301/1696 [00:01&lt;00:05,  246.56it/s]
 19%|#9        | cHPI locations  : 325/1696 [00:01&lt;00:05,  270.68it/s]
 20%|##        | cHPI locations  : 346/1696 [00:01&lt;00:04,  291.27it/s]
 22%|##1       | cHPI locations  : 366/1696 [00:01&lt;00:04,  310.88it/s]
 23%|##2       | cHPI locations  : 386/1696 [00:01&lt;00:03,  330.67it/s]
 24%|##3       | cHPI locations  : 401/1696 [00:01&lt;00:04,  305.45it/s]
 26%|##5       | cHPI locations  : 433/1696 [00:01&lt;00:03,  339.23it/s]
 28%|##7       | cHPI locations  : 472/1696 [00:01&lt;00:03,  382.37it/s]
 29%|##9       | cHPI locations  : 496/1696 [00:01&lt;00:02,  405.70it/s]
 30%|##9       | cHPI locations  : 501/1696 [00:01&lt;00:03,  361.93it/s]
 31%|###       | cHPI locations  : 520/1696 [00:01&lt;00:03,  378.39it/s]
 32%|###1      | cHPI locations  : 540/1696 [00:01&lt;00:02,  396.26it/s]
 33%|###2      | cHPI locations  : 559/1696 [00:01&lt;00:03,  358.36it/s]
 33%|###3      | cHPI locations  : 568/1696 [00:02&lt;00:03,  322.85it/s]
 34%|###3      | cHPI locations  : 573/1696 [00:02&lt;00:03,  289.85it/s]
 34%|###4      | cHPI locations  : 577/1696 [00:02&lt;00:04,  260.88it/s]
 34%|###4      | cHPI locations  : 581/1696 [00:02&lt;00:04,  236.08it/s]
 35%|###4      | cHPI locations  : 587/1696 [00:02&lt;00:05,  217.80it/s]
 35%|###5      | cHPI locations  : 600/1696 [00:02&lt;00:05,  208.39it/s]
 37%|###7      | cHPI locations  : 629/1696 [00:02&lt;00:04,  229.42it/s]
 38%|###8      | cHPI locations  : 648/1696 [00:02&lt;00:04,  242.47it/s]
 39%|###9      | cHPI locations  : 668/1696 [00:02&lt;00:04,  256.54it/s]
 41%|####      | cHPI locations  : 688/1696 [00:02&lt;00:03,  271.07it/s]
 41%|####1     | cHPI locations  : 700/1696 [00:02&lt;00:03,  254.03it/s]
 44%|####3     | cHPI locations  : 738/1696 [00:02&lt;00:03,  284.48it/s]
 45%|####5     | cHPI locations  : 770/1696 [00:02&lt;00:02,  309.93it/s]
 47%|####6     | cHPI locations  : 789/1696 [00:03&lt;00:03,  290.26it/s]
 47%|####6     | cHPI locations  : 794/1696 [00:03&lt;00:03,  266.00it/s]
 47%|####7     | cHPI locations  : 800/1696 [00:03&lt;00:03,  247.46it/s]
 47%|####7     | cHPI locations  : 805/1696 [00:03&lt;00:03,  229.53it/s]
 48%|####7     | cHPI locations  : 810/1696 [00:03&lt;00:04,  213.89it/s]
 48%|####8     | cHPI locations  : 815/1696 [00:03&lt;00:04,  198.50it/s]
 48%|####8     | cHPI locations  : 819/1696 [00:03&lt;00:04,  181.89it/s]
 49%|####8     | cHPI locations  : 823/1696 [00:03&lt;00:05,  171.15it/s]
 49%|####8     | cHPI locations  : 827/1696 [00:03&lt;00:05,  161.40it/s]
 49%|####9     | cHPI locations  : 833/1696 [00:04&lt;00:05,  152.25it/s]
 50%|#####     | cHPI locations  : 848/1696 [00:04&lt;00:05,  149.16it/s]
 51%|#####1    | cHPI locations  : 873/1696 [00:04&lt;00:05,  163.19it/s]
 53%|#####2    | cHPI locations  : 895/1696 [00:04&lt;00:04,  175.72it/s]
 54%|#####4    | cHPI locations  : 920/1696 [00:04&lt;00:04,  190.61it/s]
 55%|#####5    | cHPI locations  : 940/1696 [00:04&lt;00:03,  202.40it/s]
 56%|#####5    | cHPI locations  : 948/1696 [00:04&lt;00:03,  189.12it/s]
 58%|#####8    | cHPI locations  : 987/1696 [00:04&lt;00:03,  214.20it/s]
 61%|######    | cHPI locations  : 1029/1696 [00:04&lt;00:02,  242.17it/s]
 61%|######1   | cHPI locations  : 1040/1696 [00:04&lt;00:02,  228.06it/s]
 62%|######1   | cHPI locations  : 1051/1696 [00:04&lt;00:02,  215.99it/s]
 63%|######2   | cHPI locations  : 1062/1696 [00:04&lt;00:03,  206.38it/s]
 63%|######3   | cHPI locations  : 1072/1696 [00:04&lt;00:03,  196.84it/s]
 64%|######4   | cHPI locations  : 1086/1696 [00:05&lt;00:03,  189.65it/s]
 65%|######5   | cHPI locations  : 1105/1696 [00:05&lt;00:02,  199.76it/s]
 66%|######6   | cHPI locations  : 1125/1696 [00:05&lt;00:02,  210.83it/s]
 69%|######8   | cHPI locations  : 1162/1696 [00:05&lt;00:02,  233.99it/s]
 70%|######9   | cHPI locations  : 1186/1696 [00:05&lt;00:02,  229.61it/s]
 71%|#######1  | cHPI locations  : 1206/1696 [00:05&lt;00:02,  240.78it/s]
 72%|#######2  | cHPI locations  : 1226/1696 [00:05&lt;00:01,  252.28it/s]
 73%|#######3  | cHPI locations  : 1246/1696 [00:05&lt;00:01,  264.06it/s]
 75%|#######5  | cHPI locations  : 1277/1696 [00:05&lt;00:01,  284.80it/s]
 76%|#######5  | cHPI locations  : 1286/1696 [00:05&lt;00:01,  267.61it/s]
 76%|#######6  | cHPI locations  : 1296/1696 [00:05&lt;00:01,  252.63it/s]
 77%|#######6  | cHPI locations  : 1301/1696 [00:05&lt;00:01,  234.18it/s]
 77%|#######7  | cHPI locations  : 1306/1696 [00:05&lt;00:01,  219.18it/s]
 77%|#######7  | cHPI locations  : 1311/1696 [00:05&lt;00:01,  201.93it/s]
 78%|#######7  | cHPI locations  : 1315/1696 [00:06&lt;00:02,  190.10it/s]
 78%|#######7  | cHPI locations  : 1319/1696 [00:06&lt;00:02,  178.10it/s]
 78%|#######8  | cHPI locations  : 1325/1696 [00:06&lt;00:02,  168.39it/s]
 78%|#######8  | cHPI locations  : 1331/1696 [00:06&lt;00:02,  159.37it/s]
 79%|#######9  | cHPI locations  : 1341/1696 [00:06&lt;00:02,  155.18it/s]
 82%|########1 | cHPI locations  : 1383/1696 [00:06&lt;00:01,  178.71it/s]
 83%|########2 | cHPI locations  : 1402/1696 [00:06&lt;00:01,  188.72it/s]
 84%|########3 | cHPI locations  : 1421/1696 [00:06&lt;00:01,  199.01it/s]
 85%|########4 | cHPI locations  : 1440/1696 [00:06&lt;00:01,  209.64it/s]
 85%|########4 | cHPI locations  : 1441/1696 [00:06&lt;00:01,  196.89it/s]
 87%|########6 | cHPI locations  : 1472/1696 [00:06&lt;00:01,  216.11it/s]
 89%|########9 | cHPI locations  : 1514/1696 [00:06&lt;00:00,  243.84it/s]
 91%|######### | cHPI locations  : 1541/1696 [00:06&lt;00:00,  242.96it/s]
 92%|#########2| cHPI locations  : 1565/1696 [00:07&lt;00:00,  236.21it/s]
 93%|#########2| cHPI locations  : 1573/1696 [00:07&lt;00:00,  222.49it/s]
 93%|#########3| cHPI locations  : 1580/1696 [00:07&lt;00:00,  211.49it/s]
 94%|#########3| cHPI locations  : 1586/1696 [00:07&lt;00:00,  199.08it/s]
 94%|#########3| cHPI locations  : 1590/1696 [00:07&lt;00:00,  186.22it/s]
 94%|#########3| cHPI locations  : 1594/1696 [00:07&lt;00:00,  173.98it/s]
 94%|#########4| cHPI locations  : 1599/1696 [00:07&lt;00:00,  164.99it/s]
 95%|#########4| cHPI locations  : 1609/1696 [00:07&lt;00:00,  159.81it/s]
 96%|#########6| cHPI locations  : 1631/1696 [00:07&lt;00:00,  171.10it/s]
 97%|#########7| cHPI locations  : 1652/1696 [00:08&lt;00:00,  168.56it/s]
100%|#########9| cHPI locations  : 1690/1696 [00:08&lt;00:00,  189.21it/s]
100%|##########| cHPI locations  : 1696/1696 [00:08&lt;00:00,  210.71it/s]
</pre></div>
</div>
<p>Lastly, compute head positions from the coil locations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_head_pos.html#mne.chpi.compute_head_pos" title="mne.chpi.compute_head_pos" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_head_pos</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_locs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>t=9.000:     5/5 good HPI fits, movements [mm/s] =      0.1 /      0.1 /      0.5 /      0.2 /      0.3
t=10.000:    5/5 good HPI fits, movements [mm/s] =      0.1 /      0.3 /      0.0 /      0.2 /      0.1
t=11.000:    5/5 good HPI fits, movements [mm/s] =      0.1 /      0.1 /      0.1 /      0.0 /      0.1
t=12.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.0 /      0.0 /      0.0 /      0.0
t=13.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.1 /      0.0 /      0.0 /      0.0
t=14.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.0 /      0.1 /      0.1 /      0.1
t=14.580:    5/5 good HPI fits, movements [mm/s] =      5.0 /      4.8 /      6.1 /      5.5 /      4.9
t=14.670:    5/5 good HPI fits, movements [mm/s] =     33.4 /     34.2 /     39.8 /     38.1 /     30.2
t=14.720:    5/5 good HPI fits, movements [mm/s] =     49.0 /     47.4 /     60.6 /     59.1 /     44.3
t=14.760:    5/5 good HPI fits, movements [mm/s] =     65.0 /     63.1 /     72.7 /     71.1 /     56.6
t=14.800:    5/5 good HPI fits, movements [mm/s] =     66.4 /     59.4 /     83.1 /     78.3 /     60.9
t=14.860:    5/5 good HPI fits, movements [mm/s] =     54.9 /     51.8 /     57.6 /     62.1 /     47.2
t=14.990:    5/5 good HPI fits, movements [mm/s] =     23.3 /     22.5 /     24.2 /     27.0 /     19.9
t=15.990:    5/5 good HPI fits, movements [mm/s] =      0.7 /      0.9 /      0.8 /      0.8 /      0.9
t=16.880:    5/5 good HPI fits, movements [mm/s] =      2.5 /      3.4 /      3.0 /      3.8 /      3.3
t=16.930:    5/5 good HPI fits, movements [mm/s] =     52.3 /     55.7 /     58.7 /     67.2 /     59.3
t=16.990:    5/5 good HPI fits, movements [mm/s] =     57.3 /     53.6 /     61.8 /     65.1 /     57.6
t=17.040:    5/5 good HPI fits, movements [mm/s] =     53.0 /     50.1 /     60.0 /     61.8 /     49.7
t=17.090:    5/5 good HPI fits, movements [mm/s] =     57.8 /     50.2 /     66.4 /     64.8 /     51.3
t=17.140:    5/5 good HPI fits, movements [mm/s] =     60.1 /     54.5 /     73.0 /     67.1 /     57.6
t=17.180:    5/5 good HPI fits, movements [mm/s] =     63.9 /     58.4 /     74.2 /     72.1 /     62.0
t=17.220:    5/5 good HPI fits, movements [mm/s] =     60.9 /     58.9 /     75.2 /     71.5 /     63.3
t=17.260:    5/5 good HPI fits, movements [mm/s] =     67.7 /     67.0 /     73.6 /     69.0 /     69.1
t=17.320:    5/5 good HPI fits, movements [mm/s] =     49.9 /     50.9 /     54.8 /     54.9 /     52.3
t=17.470:    5/5 good HPI fits, movements [mm/s] =     18.4 /     21.8 /     19.3 /     20.5 /     17.4
t=18.470:    5/5 good HPI fits, movements [mm/s] =      1.9 /      2.6 /      2.0 /      2.4 /      1.9
t=19.390:    5/5 good HPI fits, movements [mm/s] =      2.5 /      2.7 /      1.9 /      2.9 /      2.5
t=19.500:    5/5 good HPI fits, movements [mm/s] =     23.0 /     25.2 /     19.5 /     28.8 /     27.8
t=19.610:    5/5 good HPI fits, movements [mm/s] =     21.2 /     25.6 /     21.6 /     31.8 /     31.3
t=19.710:    5/5 good HPI fits, movements [mm/s] =     21.7 /     20.7 /     23.2 /     29.7 /     27.8
t=19.850:    5/5 good HPI fits, movements [mm/s] =     16.6 /     14.8 /     18.5 /     21.7 /     20.1
t=20.850:    5/5 good HPI fits, movements [mm/s] =      2.3 /      1.9 /      2.0 /      2.5 /      2.2
t=21.850:    5/5 good HPI fits, movements [mm/s] =      0.6 /      1.7 /      1.7 /      2.0 /      1.9
t=21.950:    5/5 good HPI fits, movements [mm/s] =     25.8 /     27.1 /     24.1 /     32.1 /     26.4
t=22.000:    5/5 good HPI fits, movements [mm/s] =     66.0 /     59.4 /     46.4 /     64.7 /     51.9
t=22.050:    5/5 good HPI fits, movements [mm/s] =     59.8 /     62.5 /     51.2 /     69.1 /     57.9
t=22.100:    5/5 good HPI fits, movements [mm/s] =     61.6 /     65.3 /     58.5 /     75.1 /     64.8
t=22.140:    5/5 good HPI fits, movements [mm/s] =     74.2 /     74.0 /     62.4 /     79.8 /     68.2
t=22.180:    5/5 good HPI fits, movements [mm/s] =     63.9 /     59.3 /     53.2 /     67.3 /     53.1
t=22.240:    5/5 good HPI fits, movements [mm/s] =     38.5 /     39.4 /     36.7 /     47.9 /     42.3
t=22.300:    5/5 good HPI fits, movements [mm/s] =     41.8 /     40.0 /     33.4 /     47.5 /     39.4
t=22.400:    5/5 good HPI fits, movements [mm/s] =     31.9 /     28.5 /     22.1 /     30.8 /     24.9
t=23.400:    5/5 good HPI fits, movements [mm/s] =      1.8 /      1.8 /      1.1 /      1.5 /      1.2
t=24.400:    5/5 good HPI fits, movements [mm/s] =      1.2 /      0.8 /      0.7 /      0.8 /      0.7
t=24.640:    5/5 good HPI fits, movements [mm/s] =     12.6 /     11.6 /     11.6 /     13.0 /     10.9
t=24.720:    5/5 good HPI fits, movements [mm/s] =     30.3 /     33.1 /     31.6 /     39.0 /     35.3
t=24.790:    5/5 good HPI fits, movements [mm/s] =     31.0 /     35.8 /     32.8 /     43.0 /     40.9
t=24.850:    5/5 good HPI fits, movements [mm/s] =     37.4 /     41.0 /     35.8 /     44.8 /     42.1
t=24.890:    5/5 good HPI fits, movements [mm/s] =     50.5 /     51.6 /     50.0 /     59.8 /     53.5
t=24.930:    5/5 good HPI fits, movements [mm/s] =     55.6 /     54.9 /     59.2 /     68.7 /     61.6
t=24.980:    5/5 good HPI fits, movements [mm/s] =     47.3 /     48.0 /     51.0 /     58.4 /     53.6
t=25.080:    5/5 good HPI fits, movements [mm/s] =     23.8 /     18.9 /     23.1 /     28.2 /     26.5
t=25.510:    5/5 good HPI fits, movements [mm/s] =      2.4 /      6.4 /      7.3 /      6.5 /      7.8
</pre></div>
</div>
<p>Note that these can then be written to disk or read from disk with
<a class="reference internal" href="../../generated/mne.chpi.write_head_pos.html#mne.chpi.write_head_pos" title="mne.chpi.write_head_pos"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.write_head_pos()</span></code></a> and <a class="reference internal" href="../../generated/mne.chpi.read_head_pos.html#mne.chpi.read_head_pos" title="mne.chpi.read_head_pos"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.read_head_pos()</span></code></a>,
respectively.</p>
</div>
<div class="section" id="visualizing-continuous-head-position">
<h2>Visualizing continuous head position<a class="headerlink" href="#visualizing-continuous-head-position" title="Permalink to this headline">¶</a></h2>
<p>We can plot as traces, which is especially useful for long recordings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_head_positions.html#mne.viz.plot_head_positions" title="mne.viz.plot_head_positions" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_head_positions</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;traces&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Position (mm), Rotation (quat)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_002.png" />
<p>Or we can visualize them as a continuous field (with the vectors pointing
in the head-upward direction):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_head_positions.html#mne.viz.plot_head_positions" title="mne.viz.plot_head_positions" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_head_positions</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot 59 head positions" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_003.png" />
<p>These head positions can then be used with
<a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.preprocessing.maxwell_filter()</span></code></a> to compensate for movement,
or with <a class="reference internal" href="../../generated/mne.preprocessing.annotate_movement.html#mne.preprocessing.annotate_movement" title="mne.preprocessing.annotate_movement"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.preprocessing.annotate_movement()</span></code></a> to mark segments as
bad that deviate too much from the average head position.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  37.553 seconds)</p>
<p><strong>Estimated memory usage:</strong>  46 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-preprocessing-plot-59-head-positions-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4f4ac0e628d8f537de7f45bc3da419e1/plot_59_head_positions.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_59_head_positions.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7aed4bc8cd1643f9a23125c34f543ae6/plot_59_head_positions.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_59_head_positions.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><div class="row">
    <div class="container col-md-12 institutions">
      <ul class="list-unstyled">
        <li><a href="https://www.massgeneral.org/"><img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a></li>
        <li><a href="https://martinos.org/"><img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a></li>
        <li><a href="https://hms.harvard.edu/"><img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a></li>
        <li><a href="https://web.mit.edu/"><img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a></li>
        <li><a href="https://www.nyu.edu/"><img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a></li>
        <li><a href="http://www.cea.fr/"><img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a></li>
        <li><a href="https://sci.aalto.fi/"><img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a></li>
        <li><a href="https://www.telecom-paris.fr/"><img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a></li>
        <li><a href="https://www.washington.edu/"><img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a></li>
        <li><a href="https://icm-institute.org/"><img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a></li>
        <li><a href="https://www.bu.edu/"><img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a></li>
        <li><a href="https://www.inserm.fr/"><img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a></li>
        <li><a href="https://www.fz-juelich.de/"><img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a></li>
        <li><a href="https://www.tu-ilmenau.de/"><img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a></li>
        <li><a href="https://bids.berkeley.edu/"><img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a></li>
        <li><a href="https://www.inria.fr/"><img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a></li>
        <li><a href="https://www.au.dk/"><img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a></li>
        <li><a href="https://www.uni-graz.at/"><img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a></li>
      </ul>
      <p class="text-center text-muted small">&copy; Copyright 2012-2021, MNE Developers. Last updated <time datetime="2021-02-01T17:53:59.897848+00:00" class="localized">2021-02-01 17:53 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
    </div></div></div>
  </footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>