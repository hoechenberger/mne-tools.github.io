<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Permutation t-test on toy data with spatial clustering &#8212; MNE 0.15 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.15',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  <link rel="canonical" href="https://mne.tools/stable/index.html" />
</head>
  <body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.15</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Install</a></li>
                <li><a href="../documentation.html">Documentation</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.15
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.15 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Permutation t-test on toy data with spatial clustering</a><ul>
<li><a class="reference internal" href="#set-parameters">Set parameters</a></li>
<li><a class="reference internal" href="#construct-simulated-data">Construct simulated data</a></li>
<li><a class="reference internal" href="#do-some-statistics">Do some statistics</a></li>
<li><a class="reference internal" href="#visualize-results">Visualize results</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="permutation-t-test-on-toy-data-with-spatial-clustering">
<span id="tut-stats-cluster-methods"></span><span id="sphx-glr-auto-tutorials-plot-stats-cluster-methods-py"></span><h1>Permutation t-test on toy data with spatial clustering<a class="headerlink" href="#permutation-t-test-on-toy-data-with-spatial-clustering" title="Permalink to this headline">¶</a></h1>
<p>Following the illustrative example of Ridgway et al. 2012 <a class="footnote-reference" href="#id3" id="id1">[1]</a>,
this demonstrates some basic ideas behind both the “hat”
variance adjustment method, as well as threshold-free
cluster enhancement (TFCE) <a class="footnote-reference" href="#id4" id="id2">[2]</a> methods in mne-python.</p>
<p>This toy dataset consists of a 40 x 40 square with a “signal”
present in the center (at pixel [20, 20]) with white noise
added and a 5-pixel-SD normal smoothing kernel applied.</p>
<p>In the top row plot the T statistic over space, peaking toward the
center. Note that it has peaky edges. Second, with the “hat” variance
correction/regularization, the peak becomes correctly centered. Third,
the TFCE approach also corrects for these edge artifacts. Fourth, the
the two methods combined provide a tighter estimate, for better or
worse.</p>
<p>Now considering multiple-comparisons corrected statistics on these
variables, note that a non-cluster test (e.g., FDR or Bonferroni) would
mis-localize the peak due to sharpness in the T statistic driven by
low-variance pixels toward the edge of the plateau. Standard clustering
(first plot in the second row) identifies the correct region, but the
whole area must be declared significant, so no peak analysis can be done.
Also, the peak is broad. In this method, all significances are
family-wise error rate (FWER) corrected, and the method is
non-parametric so assumptions of Gaussian data distributions (which do
actually hold for this example) don’t need to be satisfied. Adding the
“hat” technique tightens the estimate of significant activity (second
plot). The TFCE approach (third plot) allows analyzing each significant
point independently, but still has a broadened estimate. Note that
this is also FWER corrected. Finally, combining the TFCE and “hat”
methods tightens the area declared significant (again FWER corrected),
and allows for evaluation of each point independently instead of as
a single, broad cluster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example does quite a bit of processing, so even on a
fast machine it can take a few minutes to complete.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Authors: Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="c1"># this changes hidden MPL vars:</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># noqa</span>

<span class="kn">from</span> <span class="nn">mne.stats</span> <span class="kn">import</span> <span class="p">(</span><a href="../generated/mne.stats.spatio_temporal_cluster_1samp_test.html#mne.stats.spatio_temporal_cluster_1samp_test" title="View documentation for mne.stats.spatio_temporal_cluster_1samp_test"><span class="n">spatio_temporal_cluster_1samp_test</span></a><span class="p">,</span>
                       <a href="../generated/mne.stats.bonferroni_correction.html#mne.stats.bonferroni_correction" title="View documentation for mne.stats.bonferroni_correction"><span class="n">bonferroni_correction</span></a><span class="p">,</span> <a href="../generated/mne.stats.ttest_1samp_no_p.html#mne.stats.ttest_1samp_no_p" title="View documentation for mne.stats.ttest_1samp_no_p"><span class="n">ttest_1samp_no_p</span></a><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sklearn.feature_extraction.image</span> <span class="kn">import</span> <span class="n">grid_to_graph</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">scikits.learn.feature_extraction.image</span> <span class="kn">import</span> <span class="n">grid_to_graph</span>

<span class="k">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="set-parameters">
<h2>Set parameters<a class="headerlink" href="#set-parameters" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">signal_mean</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">signal_sd</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">noise_sd</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">gaussian_sd</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># sigma for the &quot;hat&quot; method</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="n">stats</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">n_subjects</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">threshold_tfce</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">1024</span>  <span class="c1"># number of clustering permutations (1024 for exact)</span>
</pre></div>
</div>
</div>
<div class="section" id="construct-simulated-data">
<h2>Construct simulated data<a class="headerlink" href="#construct-simulated-data" title="Permalink to this headline">¶</a></h2>
<p>Make the connectivity matrix just next-neighbor spatially</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">n_src</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">width</span>
<span class="n">connectivity</span> <span class="o">=</span> <span class="n">grid_to_graph</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

<span class="c1">#    For each &quot;subject&quot;, make a smoothed noisy signal with a centered peak</span>
<span class="n">rng</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="View documentation for numpy.random.RandomState"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span></a><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">noise_sd</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="c1">#    Add a signal at the dead center</span>
<span class="n">X</span><span class="p">[:,</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal_mean</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">)</span> <span class="o">*</span> <span class="n">signal_sd</span>
<span class="c1">#    Spatially smooth with a 2D Gaussian kernel</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">gaussian</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.exp.html#numpy.exp" title="View documentation for numpy.exp"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.arange.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">gaussian_sd</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">X</span><span class="p">[</span><span class="n">si</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.convolve.html#numpy.convolve" title="View documentation for numpy.convolve"><span class="n">np</span><span class="o">.</span><span class="n">convolve</span></a><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">si</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="p">:],</span> <span class="n">gaussian</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">X</span><span class="p">[</span><span class="n">si</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.convolve.html#numpy.convolve" title="View documentation for numpy.convolve"><span class="n">np</span><span class="o">.</span><span class="n">convolve</span></a><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">si</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ci</span><span class="p">],</span> <span class="n">gaussian</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="do-some-statistics">
<h2>Do some statistics<a class="headerlink" href="#do-some-statistics" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">X needs to be a multi-dimensional array of shape
samples (subjects) x time x space, so we permute dimensions:</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_subjects</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_src</span><span class="p">))</span>
</pre></div>
</div>
<p>Now let’s do some clustering using the standard method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Not specifying a connectivity matrix implies grid-like connectivity,
which we want here:</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">T_obs</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">H0</span> <span class="o">=</span> \
    <a href="../generated/mne.stats.spatio_temporal_cluster_1samp_test.html#mne.stats.spatio_temporal_cluster_1samp_test" title="View documentation for mne.stats.spatio_temporal_cluster_1samp_test"><span class="n">spatio_temporal_cluster_1samp_test</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
                                       <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="p">,</span>
                                       <span class="n">tail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_permutations</span><span class="o">=</span><span class="n">n_permutations</span><span class="p">)</span>

<span class="c1">#    Let&#39;s put the cluster data in a readable format</span>
<span class="n">ps</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.zeros.html#numpy.zeros" title="View documentation for numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cl</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">):</span>
    <span class="n">ps</span><span class="p">[</span><span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
<span class="n">T_obs</span> <span class="o">=</span> <span class="n">T_obs</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>

<span class="c1">#     To do a Bonferroni correction on these data is simple:</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">n_subjects</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p_bon</span> <span class="o">=</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="../generated/mne.stats.bonferroni_correction.html#mne.stats.bonferroni_correction" title="View documentation for mne.stats.bonferroni_correction"><span class="n">bonferroni_correction</span></a><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#    Now let&#39;s do some clustering using the standard method with &quot;hat&quot;:</span>
<span class="n">stat_fun</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><a href="../generated/mne.stats.ttest_1samp_no_p.html#mne.stats.ttest_1samp_no_p" title="View documentation for mne.stats.ttest_1samp_no_p"><span class="n">ttest_1samp_no_p</span></a><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">T_obs_hat</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">H0</span> <span class="o">=</span> \
    <a href="../generated/mne.stats.spatio_temporal_cluster_1samp_test.html#mne.stats.spatio_temporal_cluster_1samp_test" title="View documentation for mne.stats.spatio_temporal_cluster_1samp_test"><span class="n">spatio_temporal_cluster_1samp_test</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
                                       <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="p">,</span>
                                       <span class="n">tail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_permutations</span><span class="o">=</span><span class="n">n_permutations</span><span class="p">,</span>
                                       <span class="n">stat_fun</span><span class="o">=</span><span class="n">stat_fun</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="c1">#    Let&#39;s put the cluster data in a readable format</span>
<span class="n">ps_hat</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.zeros.html#numpy.zeros" title="View documentation for numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cl</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">):</span>
    <span class="n">ps_hat</span><span class="p">[</span><span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">ps_hat</span> <span class="o">=</span> <span class="n">ps_hat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
<span class="n">T_obs_hat</span> <span class="o">=</span> <span class="n">T_obs_hat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>

<span class="c1">#    Now the threshold-free cluster enhancement method (TFCE):</span>
<span class="n">T_obs_tfce</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">H0</span> <span class="o">=</span> \
    <a href="../generated/mne.stats.spatio_temporal_cluster_1samp_test.html#mne.stats.spatio_temporal_cluster_1samp_test" title="View documentation for mne.stats.spatio_temporal_cluster_1samp_test"><span class="n">spatio_temporal_cluster_1samp_test</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold_tfce</span><span class="p">,</span>
                                       <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="p">,</span>
                                       <span class="n">tail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_permutations</span><span class="o">=</span><span class="n">n_permutations</span><span class="p">)</span>
<span class="n">T_obs_tfce</span> <span class="o">=</span> <span class="n">T_obs_tfce</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
<span class="n">ps_tfce</span> <span class="o">=</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="n">p_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)))</span>

<span class="c1">#    Now the TFCE with &quot;hat&quot; variance correction:</span>
<span class="n">T_obs_tfce_hat</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">H0</span> <span class="o">=</span> \
    <a href="../generated/mne.stats.spatio_temporal_cluster_1samp_test.html#mne.stats.spatio_temporal_cluster_1samp_test" title="View documentation for mne.stats.spatio_temporal_cluster_1samp_test"><span class="n">spatio_temporal_cluster_1samp_test</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold_tfce</span><span class="p">,</span>
                                       <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="p">,</span>
                                       <span class="n">tail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_permutations</span><span class="o">=</span><span class="n">n_permutations</span><span class="p">,</span>
                                       <span class="n">stat_fun</span><span class="o">=</span><span class="n">stat_fun</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">T_obs_tfce_hat</span> <span class="o">=</span> <span class="n">T_obs_tfce_hat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
<span class="n">ps_tfce_hat</span> <span class="o">=</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="n">p_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">stat_fun</span><span class="p">(</span><span class="n">H1</span><span class="p">):</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">2.676791</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.182156</span>
<span class="n">Running</span> <span class="n">initial</span> <span class="n">clustering</span>
<span class="n">Found</span> <span class="mi">1</span> <span class="n">clusters</span>
<span class="n">Permuting</span> <span class="mi">1023</span> <span class="n">times</span> <span class="p">(</span><span class="n">exact</span> <span class="n">test</span><span class="p">)</span><span class="o">...</span>

<span class="p">[</span>                                        <span class="p">]</span> <span class="mf">0.09775</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.</span>                                       <span class="p">]</span> <span class="mf">3.12805</span> <span class="o">/</span>
<span class="p">[</span><span class="o">..</span>                                      <span class="p">]</span> <span class="mf">6.25611</span> <span class="o">-</span>
<span class="p">[</span><span class="o">...</span>                                     <span class="p">]</span> <span class="mf">9.38416</span> \
<span class="p">[</span><span class="o">.....</span>                                   <span class="p">]</span> <span class="mf">12.51222</span> <span class="o">|</span>
<span class="p">[</span><span class="o">......</span>                                  <span class="p">]</span> <span class="mf">15.64027</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.......</span>                                 <span class="p">]</span> <span class="mf">18.76833</span> <span class="o">-</span>
<span class="p">[</span><span class="o">........</span>                                <span class="p">]</span> <span class="mf">21.89638</span> \
<span class="p">[</span><span class="o">..........</span>                              <span class="p">]</span> <span class="mf">25.02444</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...........</span>                             <span class="p">]</span> <span class="mf">28.15249</span> <span class="o">/</span>
<span class="p">[</span><span class="o">............</span>                            <span class="p">]</span> <span class="mf">31.28055</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.............</span>                           <span class="p">]</span> <span class="mf">34.40860</span> \
<span class="p">[</span><span class="o">...............</span>                         <span class="p">]</span> <span class="mf">37.53666</span> <span class="o">|</span>
<span class="p">[</span><span class="o">................</span>                        <span class="p">]</span> <span class="mf">40.66471</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.................</span>                       <span class="p">]</span> <span class="mf">43.79277</span> <span class="o">-</span>
<span class="p">[</span><span class="o">..................</span>                      <span class="p">]</span> <span class="mf">46.92082</span> \
<span class="p">[</span><span class="o">....................</span>                    <span class="p">]</span> <span class="mf">50.04888</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.....................</span>                   <span class="p">]</span> <span class="mf">53.17693</span> <span class="o">/</span>
<span class="p">[</span><span class="o">......................</span>                  <span class="p">]</span> <span class="mf">56.30499</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.......................</span>                 <span class="p">]</span> <span class="mf">59.43304</span> \
<span class="p">[</span><span class="o">.........................</span>               <span class="p">]</span> <span class="mf">62.56109</span> <span class="o">|</span>
<span class="p">[</span><span class="o">..........................</span>              <span class="p">]</span> <span class="mf">65.68915</span> <span class="o">/</span>
<span class="p">[</span><span class="o">...........................</span>             <span class="p">]</span> <span class="mf">68.81720</span> <span class="o">-</span>
<span class="p">[</span><span class="o">............................</span>            <span class="p">]</span> <span class="mf">71.94526</span> \
<span class="p">[</span><span class="o">..............................</span>          <span class="p">]</span> <span class="mf">75.07331</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...............................</span>         <span class="p">]</span> <span class="mf">78.20137</span> <span class="o">/</span>
<span class="p">[</span><span class="o">................................</span>        <span class="p">]</span> <span class="mf">81.32942</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.................................</span>       <span class="p">]</span> <span class="mf">84.45748</span> \
<span class="p">[</span><span class="o">...................................</span>     <span class="p">]</span> <span class="mf">87.58553</span> <span class="o">|</span>
<span class="p">[</span><span class="o">....................................</span>    <span class="p">]</span> <span class="mf">90.71359</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.....................................</span>   <span class="p">]</span> <span class="mf">93.84164</span> <span class="o">-</span>
<span class="p">[</span><span class="o">......................................</span>  <span class="p">]</span> <span class="mf">96.96970</span> \    <span class="n">Computing</span> <span class="n">cluster</span> <span class="n">p</span><span class="o">-</span><span class="n">values</span>
<span class="n">Done</span><span class="o">.</span>
<span class="n">stat_fun</span><span class="p">(</span><span class="n">H1</span><span class="p">):</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">0.044294</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.600984</span>
<span class="n">Running</span> <span class="n">initial</span> <span class="n">clustering</span>
<span class="n">Found</span> <span class="mi">1</span> <span class="n">clusters</span>
<span class="n">Permuting</span> <span class="mi">1023</span> <span class="n">times</span> <span class="p">(</span><span class="n">exact</span> <span class="n">test</span><span class="p">)</span><span class="o">...</span>

<span class="p">[</span>                                        <span class="p">]</span> <span class="mf">0.09775</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.</span>                                       <span class="p">]</span> <span class="mf">3.12805</span> <span class="o">/</span>
<span class="p">[</span><span class="o">..</span>                                      <span class="p">]</span> <span class="mf">6.25611</span> <span class="o">-</span>
<span class="p">[</span><span class="o">...</span>                                     <span class="p">]</span> <span class="mf">9.38416</span> \
<span class="p">[</span><span class="o">.....</span>                                   <span class="p">]</span> <span class="mf">12.51222</span> <span class="o">|</span>
<span class="p">[</span><span class="o">......</span>                                  <span class="p">]</span> <span class="mf">15.64027</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.......</span>                                 <span class="p">]</span> <span class="mf">18.76833</span> <span class="o">-</span>
<span class="p">[</span><span class="o">........</span>                                <span class="p">]</span> <span class="mf">21.89638</span> \
<span class="p">[</span><span class="o">..........</span>                              <span class="p">]</span> <span class="mf">25.02444</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...........</span>                             <span class="p">]</span> <span class="mf">28.15249</span> <span class="o">/</span>
<span class="p">[</span><span class="o">............</span>                            <span class="p">]</span> <span class="mf">31.28055</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.............</span>                           <span class="p">]</span> <span class="mf">34.40860</span> \
<span class="p">[</span><span class="o">...............</span>                         <span class="p">]</span> <span class="mf">37.53666</span> <span class="o">|</span>
<span class="p">[</span><span class="o">................</span>                        <span class="p">]</span> <span class="mf">40.66471</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.................</span>                       <span class="p">]</span> <span class="mf">43.79277</span> <span class="o">-</span>
<span class="p">[</span><span class="o">..................</span>                      <span class="p">]</span> <span class="mf">46.92082</span> \
<span class="p">[</span><span class="o">....................</span>                    <span class="p">]</span> <span class="mf">50.04888</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.....................</span>                   <span class="p">]</span> <span class="mf">53.17693</span> <span class="o">/</span>
<span class="p">[</span><span class="o">......................</span>                  <span class="p">]</span> <span class="mf">56.30499</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.......................</span>                 <span class="p">]</span> <span class="mf">59.43304</span> \
<span class="p">[</span><span class="o">.........................</span>               <span class="p">]</span> <span class="mf">62.56109</span> <span class="o">|</span>
<span class="p">[</span><span class="o">..........................</span>              <span class="p">]</span> <span class="mf">65.68915</span> <span class="o">/</span>
<span class="p">[</span><span class="o">...........................</span>             <span class="p">]</span> <span class="mf">68.81720</span> <span class="o">-</span>
<span class="p">[</span><span class="o">............................</span>            <span class="p">]</span> <span class="mf">71.94526</span> \
<span class="p">[</span><span class="o">..............................</span>          <span class="p">]</span> <span class="mf">75.07331</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...............................</span>         <span class="p">]</span> <span class="mf">78.20137</span> <span class="o">/</span>
<span class="p">[</span><span class="o">................................</span>        <span class="p">]</span> <span class="mf">81.32942</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.................................</span>       <span class="p">]</span> <span class="mf">84.45748</span> \
<span class="p">[</span><span class="o">...................................</span>     <span class="p">]</span> <span class="mf">87.58553</span> <span class="o">|</span>
<span class="p">[</span><span class="o">....................................</span>    <span class="p">]</span> <span class="mf">90.71359</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.....................................</span>   <span class="p">]</span> <span class="mf">93.84164</span> <span class="o">-</span>
<span class="p">[</span><span class="o">......................................</span>  <span class="p">]</span> <span class="mf">96.96970</span> \    <span class="n">Computing</span> <span class="n">cluster</span> <span class="n">p</span><span class="o">-</span><span class="n">values</span>
<span class="n">Done</span><span class="o">.</span>
<span class="n">stat_fun</span><span class="p">(</span><span class="n">H1</span><span class="p">):</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">2.676791</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.182156</span>
<span class="n">Running</span> <span class="n">initial</span> <span class="n">clustering</span>
<span class="n">Using</span> <span class="mi">26</span> <span class="n">thresholds</span> <span class="kn">from</span> <span class="mf">0.00</span> <span class="n">to</span> <span class="mf">5.00</span> <span class="k">for</span> <span class="n">TFCE</span> <span class="n">computation</span> <span class="p">(</span><span class="n">h_power</span><span class="o">=</span><span class="mf">2.00</span><span class="p">,</span> <span class="n">e_power</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
<span class="n">Found</span> <span class="mi">1600</span> <span class="n">clusters</span>
<span class="n">Permuting</span> <span class="mi">1023</span> <span class="n">times</span> <span class="p">(</span><span class="n">exact</span> <span class="n">test</span><span class="p">)</span><span class="o">...</span>

<span class="p">[</span>                                        <span class="p">]</span> <span class="mf">0.09775</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.</span>                                       <span class="p">]</span> <span class="mf">3.12805</span> <span class="o">/</span>
<span class="p">[</span><span class="o">..</span>                                      <span class="p">]</span> <span class="mf">6.25611</span> <span class="o">-</span>
<span class="p">[</span><span class="o">...</span>                                     <span class="p">]</span> <span class="mf">9.38416</span> \
<span class="p">[</span><span class="o">.....</span>                                   <span class="p">]</span> <span class="mf">12.51222</span> <span class="o">|</span>
<span class="p">[</span><span class="o">......</span>                                  <span class="p">]</span> <span class="mf">15.64027</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.......</span>                                 <span class="p">]</span> <span class="mf">18.76833</span> <span class="o">-</span>
<span class="p">[</span><span class="o">........</span>                                <span class="p">]</span> <span class="mf">21.89638</span> \
<span class="p">[</span><span class="o">..........</span>                              <span class="p">]</span> <span class="mf">25.02444</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...........</span>                             <span class="p">]</span> <span class="mf">28.15249</span> <span class="o">/</span>
<span class="p">[</span><span class="o">............</span>                            <span class="p">]</span> <span class="mf">31.28055</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.............</span>                           <span class="p">]</span> <span class="mf">34.40860</span> \
<span class="p">[</span><span class="o">...............</span>                         <span class="p">]</span> <span class="mf">37.53666</span> <span class="o">|</span>
<span class="p">[</span><span class="o">................</span>                        <span class="p">]</span> <span class="mf">40.66471</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.................</span>                       <span class="p">]</span> <span class="mf">43.79277</span> <span class="o">-</span>
<span class="p">[</span><span class="o">..................</span>                      <span class="p">]</span> <span class="mf">46.92082</span> \
<span class="p">[</span><span class="o">....................</span>                    <span class="p">]</span> <span class="mf">50.04888</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.....................</span>                   <span class="p">]</span> <span class="mf">53.17693</span> <span class="o">/</span>
<span class="p">[</span><span class="o">......................</span>                  <span class="p">]</span> <span class="mf">56.30499</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.......................</span>                 <span class="p">]</span> <span class="mf">59.43304</span> \
<span class="p">[</span><span class="o">.........................</span>               <span class="p">]</span> <span class="mf">62.56109</span> <span class="o">|</span>
<span class="p">[</span><span class="o">..........................</span>              <span class="p">]</span> <span class="mf">65.68915</span> <span class="o">/</span>
<span class="p">[</span><span class="o">...........................</span>             <span class="p">]</span> <span class="mf">68.81720</span> <span class="o">-</span>
<span class="p">[</span><span class="o">............................</span>            <span class="p">]</span> <span class="mf">71.94526</span> \
<span class="p">[</span><span class="o">..............................</span>          <span class="p">]</span> <span class="mf">75.07331</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...............................</span>         <span class="p">]</span> <span class="mf">78.20137</span> <span class="o">/</span>
<span class="p">[</span><span class="o">................................</span>        <span class="p">]</span> <span class="mf">81.32942</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.................................</span>       <span class="p">]</span> <span class="mf">84.45748</span> \
<span class="p">[</span><span class="o">...................................</span>     <span class="p">]</span> <span class="mf">87.58553</span> <span class="o">|</span>
<span class="p">[</span><span class="o">....................................</span>    <span class="p">]</span> <span class="mf">90.71359</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.....................................</span>   <span class="p">]</span> <span class="mf">93.84164</span> <span class="o">-</span>
<span class="p">[</span><span class="o">......................................</span>  <span class="p">]</span> <span class="mf">96.96970</span> \    <span class="n">Computing</span> <span class="n">cluster</span> <span class="n">p</span><span class="o">-</span><span class="n">values</span>
<span class="n">Done</span><span class="o">.</span>
<span class="n">stat_fun</span><span class="p">(</span><span class="n">H1</span><span class="p">):</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">0.044294</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.600984</span>
<span class="n">Running</span> <span class="n">initial</span> <span class="n">clustering</span>
<span class="n">Using</span> <span class="mi">24</span> <span class="n">thresholds</span> <span class="kn">from</span> <span class="mf">0.00</span> <span class="n">to</span> <span class="mf">4.60</span> <span class="k">for</span> <span class="n">TFCE</span> <span class="n">computation</span> <span class="p">(</span><span class="n">h_power</span><span class="o">=</span><span class="mf">2.00</span><span class="p">,</span> <span class="n">e_power</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
<span class="n">Found</span> <span class="mi">1600</span> <span class="n">clusters</span>
<span class="n">Permuting</span> <span class="mi">1023</span> <span class="n">times</span> <span class="p">(</span><span class="n">exact</span> <span class="n">test</span><span class="p">)</span><span class="o">...</span>

<span class="p">[</span>                                        <span class="p">]</span> <span class="mf">0.09775</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.</span>                                       <span class="p">]</span> <span class="mf">3.12805</span> <span class="o">/</span>
<span class="p">[</span><span class="o">..</span>                                      <span class="p">]</span> <span class="mf">6.25611</span> <span class="o">-</span>
<span class="p">[</span><span class="o">...</span>                                     <span class="p">]</span> <span class="mf">9.38416</span> \
<span class="p">[</span><span class="o">.....</span>                                   <span class="p">]</span> <span class="mf">12.51222</span> <span class="o">|</span>
<span class="p">[</span><span class="o">......</span>                                  <span class="p">]</span> <span class="mf">15.64027</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.......</span>                                 <span class="p">]</span> <span class="mf">18.76833</span> <span class="o">-</span>
<span class="p">[</span><span class="o">........</span>                                <span class="p">]</span> <span class="mf">21.89638</span> \
<span class="p">[</span><span class="o">..........</span>                              <span class="p">]</span> <span class="mf">25.02444</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...........</span>                             <span class="p">]</span> <span class="mf">28.15249</span> <span class="o">/</span>
<span class="p">[</span><span class="o">............</span>                            <span class="p">]</span> <span class="mf">31.28055</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.............</span>                           <span class="p">]</span> <span class="mf">34.40860</span> \
<span class="p">[</span><span class="o">...............</span>                         <span class="p">]</span> <span class="mf">37.53666</span> <span class="o">|</span>
<span class="p">[</span><span class="o">................</span>                        <span class="p">]</span> <span class="mf">40.66471</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.................</span>                       <span class="p">]</span> <span class="mf">43.79277</span> <span class="o">-</span>
<span class="p">[</span><span class="o">..................</span>                      <span class="p">]</span> <span class="mf">46.92082</span> \
<span class="p">[</span><span class="o">....................</span>                    <span class="p">]</span> <span class="mf">50.04888</span> <span class="o">|</span>
<span class="p">[</span><span class="o">.....................</span>                   <span class="p">]</span> <span class="mf">53.17693</span> <span class="o">/</span>
<span class="p">[</span><span class="o">......................</span>                  <span class="p">]</span> <span class="mf">56.30499</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.......................</span>                 <span class="p">]</span> <span class="mf">59.43304</span> \
<span class="p">[</span><span class="o">.........................</span>               <span class="p">]</span> <span class="mf">62.56109</span> <span class="o">|</span>
<span class="p">[</span><span class="o">..........................</span>              <span class="p">]</span> <span class="mf">65.68915</span> <span class="o">/</span>
<span class="p">[</span><span class="o">...........................</span>             <span class="p">]</span> <span class="mf">68.81720</span> <span class="o">-</span>
<span class="p">[</span><span class="o">............................</span>            <span class="p">]</span> <span class="mf">71.94526</span> \
<span class="p">[</span><span class="o">..............................</span>          <span class="p">]</span> <span class="mf">75.07331</span> <span class="o">|</span>
<span class="p">[</span><span class="o">...............................</span>         <span class="p">]</span> <span class="mf">78.20137</span> <span class="o">/</span>
<span class="p">[</span><span class="o">................................</span>        <span class="p">]</span> <span class="mf">81.32942</span> <span class="o">-</span>
<span class="p">[</span><span class="o">.................................</span>       <span class="p">]</span> <span class="mf">84.45748</span> \
<span class="p">[</span><span class="o">...................................</span>     <span class="p">]</span> <span class="mf">87.58553</span> <span class="o">|</span>
<span class="p">[</span><span class="o">....................................</span>    <span class="p">]</span> <span class="mf">90.71359</span> <span class="o">/</span>
<span class="p">[</span><span class="o">.....................................</span>   <span class="p">]</span> <span class="mf">93.84164</span> <span class="o">-</span>
<span class="p">[</span><span class="o">......................................</span>  <span class="p">]</span> <span class="mf">96.96970</span> \    <span class="n">Computing</span> <span class="n">cluster</span> <span class="n">p</span><span class="o">-</span><span class="n">values</span>
<span class="n">Done</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="visualize-results">
<h2>Visualize results<a class="headerlink" href="#visualize-results" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.mgrid.html#numpy.mgrid" title="View documentation for numpy.mgrid"><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span></a><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">width</span><span class="p">]</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">)</span>

<span class="n">Ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">T_obs_hat</span><span class="p">,</span> <span class="n">T_obs_tfce</span><span class="p">,</span> <span class="n">T_obs_tfce_hat</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;T with &quot;hat&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;TFCE statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;TFCE w/&quot;hat&quot; stat&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span> <span class="n">titles</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="n">p_lims</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><a href="https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.log10.html#numpy.log10" title="View documentation for numpy.log10"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_permutations</span><span class="p">)]</span>
<span class="n">pvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">ps</span><span class="p">,</span> <span class="n">ps_hat</span><span class="p">,</span> <span class="n">ps_tfce</span><span class="p">,</span> <span class="n">ps_tfce_hat</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Standard clustering&#39;</span><span class="p">,</span> <span class="s1">&#39;Clust. w/&quot;hat&quot;&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Clust. w/TFCE&#39;</span><span class="p">,</span> <span class="s1">&#39;Clust. w/TFCE+&quot;hat&quot;&#39;</span><span class="p">]</span>
<span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pvals</span><span class="p">,</span> <span class="n">titles</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">ii</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="View documentation for matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Purples&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">p_lims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">p_lims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
    <span class="n">cbar</span> <span class="o">=</span> <a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="View documentation for matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
                        <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;-log10(p)&#39;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">p_lims</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%0.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_lims</span><span class="p">])</span>

<a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_stats_cluster_methods_001.png" class="align-center" src="../_images/sphx_glr_plot_stats_cluster_methods_001.png" />
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Ridgway et al. 2012, “The problem of low variance voxels in
statistical parametric mapping; a new hat avoids a ‘haircut’”,
NeuroImage. 2012 Feb 1;59(3):2131-41.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Smith and Nichols 2009, “Threshold-free cluster enhancement:
addressing problems of smoothing, threshold dependence, and
localisation in cluster inference”, NeuroImage 44 (2009) 83-98.</td></tr>
</tbody>
</table>
<p><strong>Total running time of the script:</strong> ( 2 minutes  3.258 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_stats_cluster_methods.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_stats_cluster_methods.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_stats_cluster_methods.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_stats_cluster_methods.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2017, MNE Developers. Last updated on 2017-10-31.</p>
  </div>
</footer>
<script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>